"use strict";(self.webpackChunksummary=self.webpackChunksummary||[]).push([["2589"],{72980(e,t,n){n.r(t),n.d(t,{metadata:()=>a,default:()=>c,frontMatter:()=>o,contentTitle:()=>l,toc:()=>d,assets:()=>p});var a=JSON.parse('{"id":"background/Java/JavaBase/file-upload","title":"Java File Related","description":"Using Spring-Boot with Resttemplate requires no extra packages<br/> <details> <summary>Controller</summary> java package whalefall.filedownloadorup;","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/background/Java/JavaBase/file upload.mdx","sourceDirName":"background/Java/JavaBase","slug":"/background/Java/JavaBase/file-upload","permalink":"/en/background/Java/JavaBase/file-upload","draft":false,"unlisted":false,"editUrl":"https://github.com/Halcyon666/summary/edit/main/docs/background/Java/JavaBase/file upload.mdx","tags":[{"inline":true,"label":"algorithm","permalink":"/en/tags/algorithm"},{"inline":true,"label":"computer-science","permalink":"/en/tags/computer-science"},{"inline":true,"label":"data-structures","permalink":"/en/tags/data-structures"}],"version":"current","lastUpdatedBy":"halcyon666","lastUpdatedAt":1769299200000,"sidebarPosition":10,"frontMatter":{"id":"file-upload","title":"Java File Related","sidebar_label":"Java File Related","sidebar_position":10,"description":"Using Spring-Boot with Resttemplate requires no extra packages<br/> <details> <summary>Controller</summary> java package whalefall.filedownloadorup;","tags":["algorithm","computer-science","data-structures"],"last_update":{"date":"2026-01-25","author":"halcyon666"},"sources":["spring-core"]},"sidebar":"tutorialSidebar","previous":{"title":"Java Class Description","permalink":"/en/background/Java/JavaBase/class-description"},"next":{"title":"lambda Usage","permalink":"/en/background/Java/JavaBase/lambda"}}'),r=n(62615),s=n(77545),i=n(4040);let o={id:"file-upload",title:"Java File Related",sidebar_label:"Java File Related",sidebar_position:10,description:"Using Spring-Boot with Resttemplate requires no extra packages<br/> <details> <summary>Controller</summary> java package whalefall.filedownloadorup;",tags:["algorithm","computer-science","data-structures"],last_update:{date:"2026-01-25",author:"halcyon666"},sources:["spring-core"]},l="Java File Related",p={},d=[{value:"Upload File Using RestTemplate",id:"upload-file-using-resttemplate",level:2},{value:"Upload File Using HttpClient",id:"upload-file-using-httpclient",level:2},{value:"Error When Uploading File Using Vfs2",id:"error-when-uploading-file-using-vfs2",level:2},{value:"Could not load VFS configuration from",id:"could-not-load-vfs-configuration-from",level:3},{value:"could not find file object",id:"could-not-find-file-object",level:3},{value:"Read Resource File",id:"read-resource-file",level:2}];function u(e){let t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components},{Details:n}=t;return n||function(e,t){throw Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"java-file-related",children:"Java File Related"})}),"\n",(0,r.jsx)(t.h2,{id:"upload-file-using-resttemplate",children:"Upload File Using RestTemplate"}),"\n",(0,r.jsxs)(t.p,{children:["Using Spring-Boot with Resttemplate requires no extra packages",(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(n,{children:[(0,r.jsx)("summary",{children:"Controller"}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-java",children:'package whalefall.filedownloadorup;\n\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.RequestParam;\nimport org.springframework.web.bind.annotation.RestController;\nimport org.springframework.web.multipart.MultipartFile;\n\n/**\n * @author: WhaleFall541\n * @date: 2021/11/25 22:29\n */\n@RestController\n@Slf4j\npublic class Test4HtmlController {\n\n    @PostMapping("upload1")\n    public String upload1(@RequestParam("file") MultipartFile file, @RequestParam("test") String test) {\n        log.info("upload1 {} test {}", file.getOriginalFilename(), test);\n        return "OK";\n    }\n\n}\n\n'})})]}),"\n",(0,r.jsxs)(n,{children:[(0,r.jsx)("summary",{children:"Unit Test Code Using Resttemplate FileSystemResource"}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-java",children:'package whalefall.filedownloadorup;\n\n\nimport org.junit.jupiter.api.Assertions;\nimport org.junit.jupiter.api.Test;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.core.io.FileSystemResource;\nimport org.springframework.http.*;\nimport org.springframework.util.LinkedMultiValueMap;\nimport org.springframework.util.MultiValueMap;\nimport org.springframework.web.client.RestTemplate;\n\nimport java.io.File;\n\nimport static whalefall.filedownloadorup.TestHttpClientUpload1.FILE_PATH;\nimport static whalefall.filedownloadorup.TestHttpClientUpload1.UPLOAD_URL;\n\n/**\n * @author Halcyon\n * @since 1.0.0\n */\npublic class TestRestTemplateUpload {\n    private static final Logger logger = LoggerFactory.getLogger(TestHttpClientUpload1.class);\n    @Test\n    public void testResttemplateUpload() {\n        File file = new File(FILE_PATH);\n\n        // Create RestTemplate instance\n        RestTemplate restTemplate = new RestTemplate();\n\n        // Build request body\n        MultiValueMap<String, Object> requestBody = new LinkedMultiValueMap<>();\n        // ByteArrayResource can also be used but getFilename method needs to be overridden, suitable for byte files\n        requestBody.add("file", new FileSystemResource(file)); // Add file\n        requestBody.add("test", "testResttemplateUpload test");\n\n        // Set request headers\n        HttpHeaders headers = new HttpHeaders();\n        headers.setContentType(MediaType.MULTIPART_FORM_DATA);\n\n        // Create HttpEntity, encapsulating request body and headers\n        HttpEntity<MultiValueMap<String, Object>> requestEntity = new HttpEntity<>(requestBody, headers);\n\n        // Send POST request\n        ResponseEntity<String> response = restTemplate.exchange(UPLOAD_URL, HttpMethod.POST, requestEntity, String.class);\n\n        // Get server response status code and response body\n        int statusCode = response.getStatusCodeValue();\n        String responseBody = response.getBody();\n\n        Assertions.assertEquals(200, statusCode);\n        Assertions.assertEquals("OK", responseBody);\n    }\n}\n\n'})})]}),"\n",(0,r.jsx)(t.p,{children:"Recommended to use this"}),"\n",(0,r.jsxs)(n,{children:[(0,r.jsx)("summary",{children:"Unit Test Code Using Resttemplate ByteArrayResource"}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-java",children:'package whalefall.filedownloadorup;\n\n\nimport org.junit.jupiter.api.Assertions;\nimport org.junit.jupiter.api.Test;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.core.io.ByteArrayResource;\nimport org.springframework.http.*;\nimport org.springframework.util.LinkedMultiValueMap;\nimport org.springframework.util.MultiValueMap;\nimport org.springframework.web.client.RestTemplate;\n\nimport java.io.ByteArrayOutputStream;\nimport java.io.FileInputStream;\nimport java.io.IOException;\nimport java.util.Objects;\n\nimport static whalefall.filedownloadorup.TestHttpClientUpload1.FILE_PATH;\nimport static whalefall.filedownloadorup.TestHttpClientUpload1.UPLOAD_URL;\n\n/**\n * @author Halcyon\n * @since 1.0.0\n */\npublic class TestRestTemplateUpload2 {\n    private static final Logger logger = LoggerFactory.getLogger(TestHttpClientUpload1.class);\n\n    public static byte[] readFileAsByteArray(String filePath) {\n        try (FileInputStream fis = new FileInputStream(filePath);\n             ByteArrayOutputStream bos = new ByteArrayOutputStream()) {\n\n            byte[] buffer = new byte[1024];\n            int bytesRead;\n            while ((bytesRead = fis.read(buffer)) != -1) {\n                bos.write(buffer, 0, bytesRead);\n            }\n            return bos.toByteArray();\n        } catch (IOException e) {\n            logger.error(e.getMessage(), e);\n        }\n        return null;\n    }\n\n    @Test\n    public void testResttemplateUpload() throws IOException {\n\n        // Create RestTemplate instance\n        RestTemplate restTemplate = new RestTemplate();\n\n        // Build request body\n        MultiValueMap<String, Object> requestBody = new LinkedMultiValueMap<>();\n        requestBody.add("file", new ByteArrayResource(Objects.requireNonNull(readFileAsByteArray(FILE_PATH))) {\n            @Override\n            public String getFilename() {\n                return "test.xlsx";\n            }\n        });\n        requestBody.add("test", "testResttemplateUpload2 test");\n\n        // Set request headers\n        HttpHeaders headers = new HttpHeaders();\n        headers.setContentType(MediaType.MULTIPART_FORM_DATA);\n\n        // Create HttpEntity, encapsulating request body and headers\n        HttpEntity<MultiValueMap<String, Object>> requestEntity = new HttpEntity<>(requestBody, headers);\n\n        // Send POST request\n        ResponseEntity<String> response = null;\n        try {\n            response = restTemplate.exchange(UPLOAD_URL, HttpMethod.POST, requestEntity, String.class);\n            // Get server response status code and response body\n            int statusCode = response.getStatusCodeValue();\n            String responseBody = response.getBody();\n\n            Assertions.assertEquals(200, statusCode);\n            Assertions.assertEquals("OK", responseBody);\n        } catch (Exception e) {\n            logger.error(e.getMessage(), e);\n        }\n\n    }\n}\n\n'})})]}),"\n",(0,r.jsx)(t.h2,{id:"upload-file-using-httpclient",children:"Upload File Using HttpClient"}),"\n",(0,r.jsx)(t.p,{children:"Import packages"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-groovy",children:"    implementation 'org.apache.httpcomponents:httpclient:4.5.13'\n    implementation 'org.apache.httpcomponents:httpmime:4.5.13'\n"})}),"\n",(0,r.jsxs)(n,{children:[(0,r.jsx)("summary",{children:"Unit Test Code Using HttpClient"}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-java",children:'package whalefall.filedownloadorup;\n\nimport org.apache.http.HttpEntity;\nimport org.apache.http.client.methods.CloseableHttpResponse;\nimport org.apache.http.client.methods.HttpPost;\nimport org.apache.http.entity.ContentType;\nimport org.apache.http.entity.mime.MultipartEntityBuilder;\nimport org.apache.http.impl.client.CloseableHttpClient;\nimport org.apache.http.impl.client.HttpClients;\nimport org.junit.jupiter.api.Assertions;\nimport org.junit.jupiter.api.Test;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.util.Objects;\n\n/\\*\\*\n\n- @author Halcyon\n- @since 1.0.0\n  \\*/\n  public class TestHttpClientUpload1 {\n  // Replace with path of Excel file to be sent\n  public static final String FILE_PATH = Objects.requireNonNull(TestHttpClientUpload1.class.getResource("/exceltemplet/priceListTemplate.xlsx")).getPath();// Replace with server URL receiving file\n  public static final String UPLOAD_URL = "http://localhost:8080/upload1";\n  private static final Logger logger = LoggerFactory.getLogger(TestHttpClientUpload1.class);\n\n      @Test\n      public void testHttpClientUpload() {\n\n          File file = new File(FILE_PATH);\n          // Create CloseableHttpClient instance\n          CloseableHttpClient httpClient = HttpClients.createDefault();\n          // Create HttpPost request\n          HttpPost httpPost = new HttpPost(UPLOAD_URL);\n          // Create Multipart entity\n          MultipartEntityBuilder builder = MultipartEntityBuilder.create();\n          builder.addBinaryBody("file", file, ContentType.APPLICATION_OCTET_STREAM, file.getName());\n          // Add other parameters\n          builder.addTextBody("test", "testHttpClientUpload test");\n          // Set request entity\n          HttpEntity entity = builder.build();\n          httpPost.setEntity(entity);\n          int statusCode = 500;\n          // Send HttpPost request and get server response\n          try (CloseableHttpResponse response = httpClient.execute(httpPost)) {\n              // Get server response status code\n              statusCode = response.getStatusLine().getStatusCode();\n              // Here you can handle server response, such as checking if upload successful etc.\n          } catch (IOException e) {\n              logger.error(e.getMessage(), e);\n          }\n          Assertions.assertEquals(200, statusCode);\n      }\n\n}\n\n'})})]}),"\n",(0,r.jsx)(t.h2,{id:"error-when-uploading-file-using-vfs2",children:"Error When Uploading File Using Vfs2"}),"\n",(0,r.jsx)(t.h3,{id:"could-not-load-vfs-configuration-from",children:"Could not load VFS configuration from"}),"\n",(0,r.jsx)(t.p,{children:"Error method: org.apache.commons.vfs2.impl.StandardFileSystemManager#init"}),"\n",(0,r.jsxs)(t.p,{children:["Deployment environment error:",(0,r.jsx)("br",{})]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:'Could not load VFS configuration from\n"jar:file:/opt/deployments/BOOT-INF/lib/commons-vfs2-2.9.0.jar!/org/apache/commons/vfs2/impl/providers.xml".\n'})}),"\n",(0,r.jsxs)(t.p,{children:["Local debugging error: ",(0,r.jsx)("br",{}),"\nConnection timed out: connect"]}),"\n",(0,r.jsx)(t.p,{children:"Verified, this error is indeed caused by network connectivity."}),"\n",(0,r.jsx)(t.h3,{id:"could-not-find-file-object",children:"could not find file object"}),"\n",(0,r.jsxs)(t.p,{children:["when use vfs2 upload file both in windows and linux , you must use ",(0,r.jsx)(t.code,{children:"/"})," instead of ",(0,r.jsx)(t.code,{children:"\\"}),",  otherwise it  may occur errors."]}),"\n",(0,r.jsx)(t.h2,{id:"read-resource-file",children:"Read Resource File"}),"\n",(0,r.jsxs)(t.p,{children:["Read from ",(0,r.jsx)(t.code,{children:"resource/a/a.properties"}),", here are  two scenes\uFF0C",(0,r.jsx)(t.code,{children:"FileInputStream"})," Api can be used."]}),"\n",(0,r.jsxs)(t.p,{children:["read from local project, just use file path of ",(0,r.jsx)(t.code,{children:"a/a.properties"})]}),"\n",(0,r.jsxs)(t.p,{children:["just use ",(0,r.jsx)(t.code,{children:"/BOOT-INF/classe/a/a.properties"}),", may be another path, you need to use of which your ",(0,r.jsx)(t.code,{children:"application.yml"}),"  located."]}),"\n","\n",(0,r.jsx)(i.A,{})]})}function c(e={}){let{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}}}]);