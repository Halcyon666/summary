"use strict";(self.webpackChunksummary=self.webpackChunksummary||[]).push([["3108"],{92765(e,n,o){o.r(n),o.d(n,{metadata:()=>t,default:()=>g,frontMatter:()=>s,contentTitle:()=>l,toc:()=>p,assets:()=>c});var t=JSON.parse('{"id":"background/Java/Problems/spring-boot","title":"Spring Boot","description":"A bug finds in those of tasks where you need change the date by the nature. <br/> Firstly You should inject a prototype bean to spring context, instea","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/background/Java/Problems/Spring Boot.mdx","sourceDirName":"background/Java/Problems","slug":"/background/Java/Problems/spring-boot","permalink":"/en/background/Java/Problems/spring-boot","draft":false,"unlisted":false,"editUrl":"https://github.com/Halcyon666/summary/edit/main/docs/background/Java/Problems/Spring Boot.mdx","tags":[{"inline":true,"label":"algorithm","permalink":"/en/tags/algorithm"},{"inline":true,"label":"computer-science","permalink":"/en/tags/computer-science"},{"inline":true,"label":"data-structures","permalink":"/en/tags/data-structures"}],"version":"current","lastUpdatedBy":"halcyon666","lastUpdatedAt":1769299200000,"sidebarPosition":10,"frontMatter":{"id":"spring-boot","title":"Spring Boot","sidebar_label":"Spring Boot","sidebar_position":10,"description":"A bug finds in those of tasks where you need change the date by the nature. <br/> Firstly You should inject a prototype bean to spring context, instea","tags":["algorithm","computer-science","data-structures"],"last_update":{"date":"2026-01-25","author":"halcyon666"},"sources":["spring-core"]},"sidebar":"tutorialSidebar","previous":{"title":"Production Problems","permalink":"/en/background/Java/Problems/production"},"next":{"title":"Github Related Problems Handling","permalink":"/en/background/Java/Problems/github-problems"}}'),r=o(62615),a=o(77545),i=o(4040);let s={id:"spring-boot",title:"Spring Boot",sidebar_label:"Spring Boot",sidebar_position:10,description:"A bug finds in those of tasks where you need change the date by the nature. <br/> Firstly You should inject a prototype bean to spring context, instea",tags:["algorithm","computer-science","data-structures"],last_update:{date:"2026-01-25",author:"halcyon666"},sources:["spring-core"]},l="Spring Boot",c={},p=[{value:"Singleton Inject but need dynamic changing value",id:"singleton-inject-but-need-dynamic-changing-value",level:2},{value:"Startup Problems",id:"startup-problems",level:2},{value:"Springboot startup error org.springframework.boot does not exist",id:"springboot-startup-error-orgspringframeworkboot-does-not-exist",level:3},{value:"spring boot source code running SpringApplication error",id:"spring-boot-source-code-running-springapplication-error",level:3},{value:"gradle spring boot 3.0 import error",id:"gradle-spring-boot-30-import-error",level:3},{value:"Log Related",id:"log-related",level:2},{value:"Startup console log has no color",id:"startup-console-log-has-no-color",level:3},{value:"logback modify log print content",id:"logback-modify-log-print-content",level:3},{value:"Packaging Problems",id:"packaging-problems",level:2},{value:"after run the packaged jar occurs this unable to find main class",id:"after-run-the-packaged-jar-occurs-this-unable-to-find-main-class",level:3},{value:"Get Real Class Annotation of AOP Proxy Object",id:"get-real-class-annotation-of-aop-proxy-object",level:2}];function d(e){let n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components},{Details:o}=n;return o||function(e,n){throw Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"spring-boot",children:"Spring Boot"})}),"\n",(0,r.jsx)(n.h2,{id:"singleton-inject-but-need-dynamic-changing-value",children:"Singleton Inject but need dynamic changing value"}),"\n",(0,r.jsxs)(n.p,{children:["A bug finds in those of tasks where you need change the date by the nature. ",(0,r.jsx)("br",{}),"\nFirstly You should inject a prototype bean to spring context, instead of injecting a singleton object; Secondly you need use this way."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"@Component\npublic class SingletonService {\n\n    // Use ObjectFactory (can also use javax.inject.Provider or Spring's Provider)\n    @Resource\n    // highlight-next-line\n    private ObjectFactory<PrototypeBean> prototypeBeanFactory;\n\n    public void callTest() {\n        PrototypeBean prototypeBean = prototypeBeanFactory.getObject();\n        prototypeBean.doSomething();\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"startup-problems",children:"Startup Problems"}),"\n",(0,r.jsx)(n.h3,{id:"springboot-startup-error-orgspringframeworkboot-does-not-exist",children:"Springboot startup error org.springframework.boot does not exist"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.em,{children:(0,r.jsxs)(n.strong,{children:["Suggest using method 2 to input ",(0,r.jsx)(n.code,{children:"mvn idea:idea"})," in terminal, method 1 in Spring Boot project, when running other Main method test classes, will restart SpringBoot project, if you still get from ApplicationContext, then you will receive error container already closed."]})}),"\n",(0,r.jsx)(n.a,{href:"https://blog.csdn.net/qq_35456400/article/details/107190640",children:"See blog"})]}),"\n",(0,r.jsx)(n.h3,{id:"spring-boot-source-code-running-springapplication-error",children:"spring boot source code running SpringApplication error"}),"\n",(0,r.jsxs)(n.p,{children:["Could not find artifact lifecycle-mapping:lifecycle-mapping:jar:sources:1.0.0\n",(0,r.jsx)(n.a,{href:"https://blog.csdn.net/awecoder/article/details/101159870",children:"See blog Already paid to view! Speechless"})]}),"\n",(0,r.jsx)(n.h3,{id:"gradle-spring-boot-30-import-error",children:"gradle spring boot 3.0 import error"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://stackoverflow.com/questions/69696321/intellij-invalid-source-release-17",children:"Invalid source release: 17"})}),"\n",(0,r.jsx)(n.p,{children:"Ensure gradle version JDK 17 and JDK version are correct."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://s2.loli.net/2023/07/28/UzsD4BnrPYSbo1T.png",alt:"image-20230728021351697"})}),"\n",(0,r.jsx)(n.h2,{id:"log-related",children:"Log Related"}),"\n",(0,r.jsx)(n.h3,{id:"startup-console-log-has-no-color",children:"Startup console log has no color"}),"\n",(0,r.jsx)(n.p,{children:"Introduce in spring-logback.xml"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<include resource="org/springframework/boot/logging/logback/base.xml"/>\n<logger name="org.springframework.web" level="INFO"/>\n<logger name="org.springboot.sample" level="TRACE"/>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"logback-modify-log-print-content",children:"logback modify log print content"}),"\n",(0,r.jsx)(n.p,{children:"Code: extends ThrowableHandlingConverter\nimpl convert method"}),"\n",(0,r.jsx)(n.p,{children:"logback config"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<conversionRule convertionWord="someKeyMsg" convertClass="com.xxx.xxx.Xclass"/>\n'})}),"\n",(0,r.jsx)(n.h2,{id:"packaging-problems",children:"Packaging Problems"}),"\n",(0,r.jsx)(n.h3,{id:"after-run-the-packaged-jar-occurs-this-unable-to-find-main-class",children:"after run the packaged jar occurs this unable to find main class"}),"\n",(0,r.jsx)(n.p,{children:"Method 1. Replace plugin"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:"\x3c!--<plugin>\n	<groupId>org.springframework.boot</groupId>\n	<artifactId>spring-boot-maven-plugin</artifactId>\n	<configuration>\n		<mainClass>none</mainClass>\n		<classifier>execute</classifier>\n	</configuration>\n	<executions>\n		<execution>\n			<goals>\n				<goal>repackage</goal>\n			</goals>\n		</execution>\n	</executions>\n</plugin>--\x3e\n<plugin>\n	<groupId>org.apache.maven.plugins</groupId>\n	<artifactId>maven-source-plugin</artifactId>\n	<version>3.0.1</version>\n	<executions>\n		<execution>\n			<id>attach-sources</id>\n			<goals>\n				<goal>jar</goal>\n			</goals>\n		</execution>\n	</executions>\n</plugin>\n"})}),"\n",(0,r.jsx)(n.p,{children:"Method 2: Remove spring-boot parent, then use spring boot plugin to package"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"get-real-class-annotation-of-aop-proxy-object",children:"Get Real Class Annotation of AOP Proxy Object"}),"\n",(0,r.jsxs)(n.p,{children:["In Spring Boot, after using AOP technologies like ",(0,r.jsx)(n.code,{children:"@Aspect"}),", injected Bean is ",(0,r.jsx)(n.strong,{children:"proxy object"}),".\nDirectly through ",(0,r.jsx)(n.code,{children:"getClass().getAnnotation()"})," often cannot get annotation on original class (especially JDK dynamic proxy)."]}),"\n",(0,r.jsxs)(n.p,{children:["Core Solution: Use Spring provided ",(0,r.jsx)(n.code,{children:"AopProxyUtils"})," to penetrate proxy, get final ",(0,r.jsx)(n.strong,{children:"original business class"}),"."]}),"\n",(0,r.jsxs)(o,{children:[(0,r.jsx)("summary",{children:"Click to view"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"import org.springframework.aop.framework.AopProxyUtils;\n// ...\n@Component\npublic class MyAnnotationScanner implements ApplicationRunner {\n\n    private final ApplicationContext context;\n    private final Map<String, MyAnnotation> cacheMap = new ConcurrentHashMap<>();\n\n    public MyAnnotationScanner(ApplicationContext context) {\n        this.context = context;\n    }\n\n    @Override\n    public void run(ApplicationArguments args) {\n        // 1. Get all Beans with specific annotation\n        Map<String, Object> beans = context.getBeansWithAnnotation(MyAnnotation.class);\n\n        beans.forEach((name, bean) -> {\n            // 2. Penetrate proxy, get real class (TargetClass)\n            Class<?> targetClass = AopProxyUtils.ultimateTargetClass(bean);\n            \n            // 3. Extract annotation information\n            MyAnnotation anno = AnnotationUtils.findAnnotation(targetClass, MyAnnotation.class);\n            \n            if (anno != null) {\n                cacheMap.put(targetClass.getName(), anno);\n            }\n        });\n    }\n}\n"})})]}),"\n","\n",(0,r.jsx)(i.A,{})]})}function g(e={}){let{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);