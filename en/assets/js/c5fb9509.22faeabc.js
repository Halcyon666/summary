"use strict";(self.webpackChunksummary=self.webpackChunksummary||[]).push([["4653"],{25902(e,n,r){r.r(n),r.d(n,{metadata:()=>t,default:()=>u,frontMatter:()=>o,contentTitle:()=>l,toc:()=>d,assets:()=>c});var t=JSON.parse('{"id":"background/Java/Spring/AOP/joinpoint","title":"Joinpoint","description":"Please refer to [spring-framework](https://github.com/Halcyon666/spring-framework-modified/tree/main/spring-test) for code related to this article (from official source spring-test module)","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/background/Java/Spring/AOP/joinpoint.mdx","sourceDirName":"background/Java/Spring/AOP","slug":"/background/Java/Spring/AOP/joinpoint","permalink":"/en/background/Java/Spring/AOP/joinpoint","draft":false,"unlisted":false,"editUrl":"https://github.com/Halcyon666/summary/edit/main/docs/background/Java/Spring/AOP/joinpoint.mdx","tags":[{"inline":true,"label":"algorithm","permalink":"/en/tags/algorithm"},{"inline":true,"label":"computer-science","permalink":"/en/tags/computer-science"},{"inline":true,"label":"data-structures","permalink":"/en/tags/data-structures"}],"version":"current","lastUpdatedBy":"halcyon666","lastUpdatedAt":1769299200000,"sidebarPosition":10,"frontMatter":{"id":"joinpoint","title":"Joinpoint","sidebar_label":"Joinpoint","sidebar_position":10,"description":"Please refer to [spring-framework](https://github.com/Halcyon666/spring-framework-modified/tree/main/spring-test) for code related to this article (from official source spring-test module)","tags":["algorithm","computer-science","data-structures"],"last_update":{"date":"2026-01-25","author":"halcyon666"},"sources":["spring-core"]},"sidebar":"tutorialSidebar","previous":{"title":"Aspect in Spring AOP","permalink":"/en/background/Java/Spring/AOP/aspect"},"next":{"title":"Pointcut in Spring AOP","permalink":"/en/background/Java/Spring/AOP/pointcut"}}'),s=r(62615),i=r(77545),a=r(4040);let o={id:"joinpoint",title:"Joinpoint",sidebar_label:"Joinpoint",sidebar_position:10,description:"Please refer to [spring-framework](https://github.com/Halcyon666/spring-framework-modified/tree/main/spring-test) for code related to this article (from official source spring-test module)",tags:["algorithm","computer-science","data-structures"],last_update:{date:"2026-01-25",author:"halcyon666"},sources:["spring-core"]},l,c={},d=[{value:"AOP Implementation Ways in JAVA",id:"aop-implementation-ways-in-java",level:2},{value:"Joinpoint",id:"joinpoint",level:2},{value:"Static Proxy",id:"static-proxy",level:3},{value:"Dynamic Proxy",id:"dynamic-proxy",level:3},{value:"CGLIB Bytecode Generation",id:"cglib-bytecode-generation",level:3}];function p(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components},{Details:r}=n;return r||function(e,n){throw Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["Please refer to ",(0,s.jsx)(n.a,{href:"https://github.com/Halcyon666/spring-framework-modified/tree/main/spring-test",children:"spring-framework"})," under ",(0,s.jsx)(n.code,{children:"org.springframework.mylearntest"})," package for code related to this article (from ",(0,s.jsx)(n.a,{href:"https://github.com/spring-projects/spring-framework.git",title:"official source",children:"official source"})," spring-test module)."]}),"\n",(0,s.jsx)(n.h2,{id:"aop-implementation-ways-in-java",children:"AOP Implementation Ways in JAVA"}),"\n",(0,s.jsx)(n.p,{children:"Languages capable of implementing AOP are collectively called AOL (Aspect-Oriented Language). Besides AspectJ:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"AspectC"}),"\n",(0,s.jsx)(n.li,{children:"AspectC++"}),"\n",(0,s.jsx)(n.li,{children:"Aspect.Net"}),"\n",(0,s.jsx)(n.li,{children:"AspectL(Lisp)"}),"\n",(0,s.jsx)(n.li,{children:"AspectPHP"}),"\n",(0,s.jsx)(n.li,{children:"......"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"AOP in JAVA"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Dynamic Proxy"}),"\n"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"During runtime, dynamically generate corresponding proxy objects for corresponding interfaces, encapsulate cross-cutting concern logic into InvocationHandler of dynamic proxy, then during system runtime, weave cross-cutting logic into corresponding proxy classes according to module positions where cross-cutting concern needs to be woven."}),"\n"]}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsx)(n.li,{children:"Dynamic Bytecode Enhancement"}),"\n"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Use Java tool libraries like ASM or CGLIB to dynamically construct class files of bytecode during program runtime."}),"\n",(0,s.jsx)(n.li,{children:"Weave cross-cutting logic through dynamic bytecode enhancement technology during runtime, generate corresponding subclasses for these system module classes, and add cross-cutting logic to these subclasses, so that these dynamically generated subclasses are used during application execution, thereby achieving the purpose of weaving cross-cutting logic into the system."}),"\n",(0,s.jsx)(n.li,{children:"If classes or instance methods in classes that need to be extended are declared as final, they cannot be extended by subclassing. When Spring AOP cannot use dynamic proxy mechanism to extend AOP functions, it will use dynamic bytecode enhancement technology of CGLIB library to implement AOP extension."}),"\n"]}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsx)(n.li,{children:"Java Code Generation"}),"\n"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"EJB container provides weaving information based on deployment descriptor file, will generate corresponding java code for corresponding functional module classes according to information provided by descriptor, then compile java code to generate corresponding java classes through deployment tools or deployment interfaces. Afterward, functional module classes deployed to EJB container can work normally."}),"\n"]}),"\n",(0,s.jsxs)(n.ol,{start:"4",children:["\n",(0,s.jsx)(n.li,{children:"Custom Class Loader"}),"\n"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"All class files of java programs must be loaded into Java Virtual Machine by corresponding Classloader before they can run. Default Classloader will read class bytecode file, then parse and load these class files into virtual machine for running according to class bytecode specification. If I can weave cross-cutting logic into class file during this class loading into virtual machine for running, wouldn't it complete the integration of AOP and OPP?"}),"\n",(0,s.jsx)(n.li,{children:"We can complete weaving of cross-cutting logic into system by custom class loader. Custom class loader reads weaving rules and necessary information prescribed by external files, can add cross-cutting logic to existing logic of system module classes during class file loading, then hand over modified class to java virtual machine for running. Through class loader, we can basically weave most classes and corresponding instances, function is naturally much more powerful than previous ways. However, the biggest problem with this way is use of class loader itself. Some application servers control the entire class loading system, so certain problems may occur in such scenarios."}),"\n",(0,s.jsx)(n.li,{children:"Jboss AOP and AspectWerkz framework which has been merged into AspectJ project both use custom class loader way to implement."}),"\n"]}),"\n",(0,s.jsxs)(n.ol,{start:"5",children:["\n",(0,s.jsx)(n.li,{children:"AOL Extension"}),"\n"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"AOL extension is the most powerful and most difficult to master way, AspectJ mentioned before belongs to this way. In this way, various concepts of AOP mostly have one-to-one corresponding entities in AOL. We can use extended AOL to implement any AOP concept entities and even OPP concept entities, such as Aspect and Class. All AOP concepts get the most perfect expression in AOL."}),"\n",(0,s.jsx)(n.li,{children:'Using extended AOL, it is quite powerful in expression of AOP concepts, making all cross-cutting concern logic involved in AOP can live freely in its own "kingdom" before weaving. And features like "compiling to static class can improve system running performance", "java virtual machine can load file where woven AO component is located and run it like loading normal class". Using this way requires learning an extended AOL language.'}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://s2.loli.net/2023/07/15/lArHhiuGkVqd4Nm.png",alt:""})}),"\n",(0,s.jsx)(n.h2,{id:"joinpoint",children:"Joinpoint"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Joinpoint"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Pointcut Expression"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Directly specify method name where Joinpoint is located"}),"\n",(0,s.jsx)(n.li,{children:"Regular Expression: Supported by Jboss, Spring AOP, AspectWerkz etc."}),"\n",(0,s.jsx)(n.li,{children:"Use specific Pointcut expression language: After Spring 2.0, with help of AspectJ's Pointcut expression language interpreter, supports using AspectJ's Pointcut expression language to specify Pointcut."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://s2.loli.net/2023/07/15/ZeYxB1TENhjXPRt.png",alt:""})}),"\n",(0,s.jsx)(n.h3,{id:"static-proxy",children:"Static Proxy"}),"\n",(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:"IRequestable"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"package org.springframework.mylearntest.aop.staticproxy;\n\npublic interface IRequestable {\n    void request();\n}\n"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'package org.springframework.mylearntest.aop.staticproxy;\n\npublic class RequestableImpl implements IRequestable{\n    @Override\n    public void request() {\n        System.out.println(" request process in RequestableImpl");\n    }\n}\n'})})]}),"\n",(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:"ServiceControlRequestableProxy"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'package org.springframework.mylearntest.aop.staticproxy;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\npublic class ServiceControlRequestableProxy implements IRequestable{\n    private static final Logger logger = LoggerFactory.getLogger(ServiceControlRequestableProxy.class);\n    private IRequestable requestable;\n\n    public ServiceControlRequestableProxy(IRequestable target) {\n        this.requestable = target;\n    }\n\n    @Override\n    public void request() {\n        System.out.println("request process in ServiceControlRequestableProxy");\n        requestable.request();\n    }\n\n    public static void main(String[] args) {\n        IRequestable target = new RequestableImpl();// Object to be proxied\n        IRequestable proxy = new ServiceControlRequestableProxy(target); // Pass object to be proxied into proxy via constructor\n        proxy.request();// Let proxy handle request\n    }\n}\n'})})]}),"\n",(0,s.jsx)(n.h3,{id:"dynamic-proxy",children:"Dynamic Proxy"}),"\n",(0,s.jsxs)(n.p,{children:["Dynamic proxy mechanism mainly consists of a class and an interface, namely ",(0,s.jsx)(n.code,{children:"java.lang.reflect.Proxy"})," class and ",(0,s.jsx)(n.code,{children:"java.lang.reflect.InvocationHadler"})," interface."]}),"\n",(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:"RequestCtrlInvocationHandler"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'package org.springframework.mylearntest.aop.dynamicproxy;\n\nimport java.lang.reflect.InvocationHandler;\nimport java.lang.reflect.Method;\n\npublic class RequestCtrlInvocationHandler implements InvocationHandler {\n    private Object target;\n\n    public RequestCtrlInvocationHandler(Object target) {\n        this.target = target;\n    }\n\n    @Override\n    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n        System.out.println("reflect invoke before target method");\n        if ("request".equals(method.getName())) {\n            System.out.println("dynamic proxy target method");\n            return method.invoke(target, args);\n        }\n        return null;\n    }\n}\n'})})]}),"\n",(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:"Test4DynamicProxy"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'package org.springframework.mylearntest.aop.dynamicproxy;\n\nimport org.springframework.mylearntest.aop.staticproxy.IRequestable;\nimport org.springframework.mylearntest.aop.staticproxy.RequestableImpl;\n\nimport java.lang.reflect.Proxy;\n\n@SuppressWarnings("rawtypes")\npublic class Test4DynamicProxy {\n    public static void main(String[] args) {\n        // arg1:ClassLoader arg2:Interface info arg3:InvocationHandler implementation class and pass in object to be proxied\n        IRequestable requestable = (IRequestable) Proxy.newProxyInstance(\n                Test4DynamicProxy.class.getClassLoader(),\n                new Class[]{IRequestable.class},\n                new RequestCtrlInvocationHandler(new RequestableImpl()));\n        requestable.request();\n    }\n}\n'})})]}),"\n",(0,s.jsx)(n.p,{children:'If you want to understand dynamic proxy deeply, please read "Java Reflection in Action".'}),"\n",(0,s.jsx)(n.h3,{id:"cglib-bytecode-generation",children:"CGLIB Bytecode Generation"}),"\n",(0,s.jsxs)(n.p,{children:["To use CGLIB extension subclass, first need to implement a ",(0,s.jsx)(n.code,{children:"net.sf.cglib.proxy.Callback"}),", but more often, we will directly use ",(0,s.jsx)(n.code,{children:"net.sf.cglib.proxy.MethodInterceptor"})," interface (",(0,s.jsx)(n.code,{children:"MethodInterceptor"})," extends ",(0,s.jsx)(n.code,{children:"Callback"})," interface)."]}),"\n",(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:"Requestable"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'package org.springframework.mylearntest.aop.CGLIBClassGenerate;\n\npublic class Requestable {\n    public void request(){\n        System.out.println("req in requestable without implement any interface");\n    }\n}\n'})})]}),"\n",(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:"RequestCtrlCallback"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'package org.springframework.mylearntest.aop.CGLIBClassGenerate;\n\nimport org.springframework.cglib.proxy.MethodInterceptor;\nimport org.springframework.cglib.proxy.MethodProxy;\n\nimport java.lang.reflect.Method;\n\npublic class RequestCtrlCallback implements MethodInterceptor {\n    @Override\n    public Object intercept(Object o, Method method, Object[] objects, MethodProxy methodProxy) throws Throwable {\n        if (method.getName().equals("request")) {\n            System.out.println("proxy generated by cglib intercept method request");\n            return methodProxy.invokeSuper(o, objects);\n        }\n        return null;\n    }\n}\n'})})]}),"\n",(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:"Test4CGLIB"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"package org.springframework.mylearntest.aop.CGLIBClassGenerate;\n\nimport org.springframework.cglib.proxy.Enhancer;\n\npublic class Test4CGLIB {\n    public static void main(String[] args) {\n        Enhancer enhancer = new Enhancer();\n        enhancer.setSuperclass(Requestable.class);\n        enhancer.setCallback(new RequestCtrlCallback());\n\n        Requestable proxy = (Requestable) enhancer.create();\n        proxy.request();\n    }\n}\n"})})]}),"\n","\n",(0,s.jsx)(a.A,{})]})}function u(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}}}]);