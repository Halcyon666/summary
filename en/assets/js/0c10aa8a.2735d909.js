"use strict";(self.webpackChunksummary=self.webpackChunksummary||[]).push([[5655],{180:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>c,toc:()=>l});var t=r(5893),s=r(1151);const i={title:"mysql\u5b58\u50a8\u8fc7\u7a0b",sidebar_label:"mysql\u5b58\u50a8\u8fc7\u7a0b",sidebar_position:2},a=void 0,c={id:"Java/DateBase/mysql Procedure",title:"mysql\u5b58\u50a8\u8fc7\u7a0b",description:"\u5efa\u8868SQL",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/01-Java/06-DateBase/mysql Procedure.mdx",sourceDirName:"01-Java/06-DateBase",slug:"/Java/DateBase/mysql Procedure",permalink:"/en/Java/DateBase/mysql Procedure",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"mysql\u5b58\u50a8\u8fc7\u7a0b",sidebar_label:"mysql\u5b58\u50a8\u8fc7\u7a0b",sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Oracle\u5b58\u50a8\u8fc7\u7a0b",permalink:"/en/Java/DateBase/Oracle Procedure"},next:{title:"\u4e8b\u52a1\u5904\u7406",permalink:"/en/Java/DateBase/Transaction Process"}},o={},l=[{value:"\u5efa\u8868SQL",id:"\u5efa\u8868sql",level:2},{value:"\u5b58\u50a8\u8fc7\u7a0b\u4e00",id:"\u5b58\u50a8\u8fc7\u7a0b\u4e00",level:2},{value:"\u5b58\u50a8\u8fc7\u7a0b\u4e8c",id:"\u5b58\u50a8\u8fc7\u7a0b\u4e8c",level:2},{value:"\u5b58\u50a8\u8fc7\u7a0b\u4e09",id:"\u5b58\u50a8\u8fc7\u7a0b\u4e09",level:2},{value:"mysql\u6e38\u6807\u4f7f\u7528",id:"mysql\u6e38\u6807\u4f7f\u7528",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"\u5efa\u8868sql",children:"\u5efa\u8868SQL"}),"\n",(0,t.jsx)(n.p,{children:"\u521b\u5efauser\u8868"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SET NAMES utf8mb4;\nSET FOREIGN_KEY_CHECKS = 0;\n\n-- ----------------------------\n-- Table structure for user\n-- ----------------------------\nDROP TABLE IF EXISTS `user`;\nCREATE TABLE `user`  (\n  `busiid` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,\n  `username` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT '',\n  `password` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT '',\n  `partmnt` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,\n  `uuid` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL\n) ENGINE = InnoDB CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;\n\nSET FOREIGN_KEY_CHECKS = 1;\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u521b\u5efapartment\u8868"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SET NAMES utf8mb4;\nSET FOREIGN_KEY_CHECKS = 0;\n\n-- ----------------------------\n-- Table structure for partment\n-- ----------------------------\nDROP TABLE IF EXISTS `partment`;\nCREATE TABLE `partment`  (\n  `busiid` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,\n  `username` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',\n  `password` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT '',\n  `partmnt` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,\n  `uuid` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,\n  `numb` int(50) NULL DEFAULT NULL,\n  PRIMARY KEY (`busiid`) USING BTREE\n) ENGINE = InnoDB CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;\n\nSET FOREIGN_KEY_CHECKS = 1;\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u5b58\u50a8\u8fc7\u7a0b\u4e00",children:"\u5b58\u50a8\u8fc7\u7a0b\u4e00"}),"\n",(0,t.jsx)(n.p,{children:"\u5faa\u73af\u63d2\u5165num\u6761\u6570\u636e"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"drop procedure create4user;\n\ncreate procedure create4user(in busiid varchar(100),in num int(20))\nBEGIN\nwhile num>0 do\ninsert into user select busiid,concat(num,'a'),null,'hello' as partment,replace(uuid(),\"-\",\"\") as uuid;\nset num = num - 1;\nEND WHILE;\nend;\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u5b58\u50a8\u8fc7\u7a0b\u4e8c",children:"\u5b58\u50a8\u8fc7\u7a0b\u4e8c"}),"\n",(0,t.jsx)(n.p,{children:"\u63d2\u5165\u4e00\u6761\u5173\u8054\u5b58\u50a8\u8fc7\u7a0b\u4e00\u7684busiid\u7684\u6570\u636e\u5230partment\u8868"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"drop procedure create4partment;\n\ncreate procedure create4partment(in busi varchar(100))\nBEGIN\nDECLARE NUMB int(50);\ndeclare pwd varchar(255);\nDECLARE cnt_cursor cursor for select count(*) as numb,concat('000000000001',REPLACE(unix_timestamp(current_timestamp(3)),'.','')) AS pwd from user where `busiid` = busi ;\n\n\nOPEN cnt_cursor;\nFETCH cnt_cursor INTO NUMB,pwd;\n\ninsert into partment select busi as busiid,'jackson',pwd as `password`,'hello' as partment,replace(uuid(),\"-\",\"\") as uuid,numb;\nclose cnt_cursor;\nend;\n-- \u8fd9\u4e48\u4f7f\u7528\u7684\u539f\u56e0;\u5728Orcle\u6570\u636e\u5e93\u4e2dgroup by\u8bed\u53e5\u53ea\u80fd\u4e3agroup by\u7684\n-- \u5b57\u6bb5\u6216\u8005\u805a\u96c6\u51fd\u6570\u5f53\u6709\u5f88\u591a\u975e\u805a\u96c6\u7684\u5b57\u6bb5\u4e14\u4e0d\u9700\u51fa\u73b0\u5728group by \u4e2d\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u5b58\u50a8\u8fc7\u7a0b\u5b9e\u73b0\n-- \u5c3d\u91cf\u4e0d\u8981\u4f7f\u5165\u53c2\u53d8\u91cf\u4e0e\u53d8\u91cf\u540d\u76f8\u540c\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u7ed3\u679c\u4e0e\u60f3\u8c61\u7684\u4e0d\u540c\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u5b58\u50a8\u8fc7\u7a0b\u4e09",children:"\u5b58\u50a8\u8fc7\u7a0b\u4e09"}),"\n",(0,t.jsx)(n.p,{children:"\u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b\u4e00\u548c\u5b58\u50a8\u8fc7\u7a0b\u4e8c"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:'drop procedure test4union;\n\ncreate procedure test4union(in num int(20))\nBEGIN\nDECLARE busiid varchar(36);\nset busiid = (select replace(uuid(),"-",""));\ncall create4user(busiid,num);\ncall create4partment(busiid);\nEND\n'})}),"\n",(0,t.jsxs)(n.p,{children:["\u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b\u4e09\n",(0,t.jsx)(n.code,{children:"call test4union(1234567890)"})]}),"\n",(0,t.jsx)(n.h2,{id:"mysql\u6e38\u6807\u4f7f\u7528",children:"mysql\u6e38\u6807\u4f7f\u7528"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"DROP PROCEDURE CURSOR_OPERATE;\n\nCREATE PROCEDURE CURSOR_OPERATE(in num int(20))\nBEGIN \nDECLARE CURSOR_OP1 VARCHAR(50); -- \u5b9a\u4e49\u53d8\u91cf\nDECLARE CURSOR_OP CURSOR FOR SELECT BUSIID FROM partment WHERE PARTMNT = 'hello'; -- \u5b9a\u4e49\u6e38\u6807\n\nOPEN CURSOR_OP;\n\tLOOP\n\tFETCH CURSOR_OP into CURSOR_OP1;\n\tUPDATE partment set numb = num where busiid = CURSOR_OP1; -- \u4f7f\u7528LOOP\u5faa\u73af \u6839\u636e\u6e38\u6807\u7684\u7ed3\u679c\u96c6\u5bf9\u6307\u5b9a\u884c\u8fdb\u884c\u66f4\u65b0 \n\tEND LOOP;\nCLOSE CURSOR_OP;\nEND;\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"CALL CURSOR_OPERATE('123');\n"})}),"\n",(0,t.jsx)(n.admonition,{title:"Protocol",type:"tip",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["The code section of this work is licensed under the [Apache 2.0 Protocol] (",(0,t.jsx)(n.a,{href:"https://www.apache.org/licenses/LICENSE-2.0).Subject",children:"https://www.apache.org/licenses/LICENSE-2.0).Subject"})," to license, you are free to modify the code, republish it and use it for commercial purposes.But you are required to be\uff1a"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Attribute"}),"\uff1akeeps the original author's name and source information in the original code and derived code."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Keep license"}),"\uff1akeeps the Apache 2.0 protocol file in old code and derivative code."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["The document part of this work uses the licensing of [knowledge sharing signature 4.0 international licensing agreements] (",(0,t.jsx)(n.a,{href:"http://creativeecommons.org/licenses/by/4.0/",children:"http://creativeecommons.org/licenses/by/4.0/"}),"). Subject to permission, you are free to share, including any form of reproduction or distribution of works in any media, or to deduct, modify, convert or create new works on the basis of this work.But you are required to be\uff1a"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Attribute"}),"\uff1ashould indicate the original author and source information when using all or part of this document."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Non-commercial use"}),"\uff1amay not be used for commercial publication or any other act of a commercial nature.For commercial use, please contact authors."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Conditions for sharing the same methods"}),"\uff1aCrafts that are deduced and modified on the basis of this document should continue to be licensed under the Creative Commons Attribution 4.0 International License."]}),"\n"]}),"\n"]}),"\n"]})})]})}function d(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},1151:(e,n,r)=>{r.d(n,{Z:()=>c,a:()=>a});var t=r(7294);const s={},i=t.createContext(s);function a(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);