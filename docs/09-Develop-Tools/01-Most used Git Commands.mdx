# å¸¸ç”¨ Git å‘½ä»¤

## é…ç½®åŒ–å‘½ä»¤

```shell
ssh-keygen
git config --global user.name "whalefall541"
git config --global user.email "jackchen541@sina.com"
git config --global alias.ll "log --graph --pretty=format:'%C(yellow)%h%Creset -%C(cyan)%d%Creset %s %Cgreen(%an, %cr)' --abbrev-commit"
git config --global alias.a '!git add -A && git commit -m'
```

## é…ç½®å…¨å±€.gitignore

```shell
# è¿™é‡Œæœ€å¥½å†™ç»å¯¹è·¯å¾„ æœ‰æ—¶å€™å¯èƒ½ä¸ç”Ÿæ•ˆ
git config --global core.excludesfile D:/project/.gitignore 

# .gitignoreåªèƒ½å¿½ç•¥é‚£äº›åŸæ¥æ²¡æœ‰è¢«trackçš„æ–‡ä»¶ï¼Œå¦‚æœæŸäº›æ–‡ä»¶å·²ç»è¢«çº³å…¥äº†ç‰ˆæœ¬ç®¡ç†ä¸­ï¼Œåˆ™ä¿®æ”¹.gitignoreæ˜¯æ— æ•ˆçš„ã€‚
# è§£å†³æ–¹æ³•å°±æ˜¯å…ˆæŠŠæœ¬åœ°ç¼“å­˜åˆ é™¤ï¼ˆæ”¹å˜æˆæœªtrackçŠ¶æ€ï¼‰ï¼Œç„¶åå†æäº¤:

git rm -r --cached .
git add .
```

## æŸ¥çœ‹ç±»å‘½ä»¤

```shell
# æŸ¥çœ‹ 
git log --graph --pretty=format:'%C(yellow)%h%Creset -%C(cyan)%d%Creset %s %Cgreen(%an, %cr)' --abbrev-commit
# æŸ¥çœ‹ xxxæäº¤çš„å†…å®¹
git show <commit-id>
# æŸ¥çœ‹å¼•ç”¨è®°å½•
git reflog
# æŸ¥çœ‹æ–‡ä»¶å·®å¼‚
git diff filename

# æŸ¥çœ‹å·²ç»add ä½†æ˜¯æœªcommit çš„å·®å¼‚
git diff --staged
git diff --cached
# ä»…æŸ¥çœ‹æ±‡æ€»ç»Ÿè®¡
git diff --stat branch1 branch2

# æŸ¥çœ‹ä¸¤ä¸ªæäº¤ä¹‹é—´æŸä¸ªæ–‡ä»¶çš„å·®å¼‚ ç¬¬ä¸€ä¸ªä¸ºå¼€å§‹çš„hashï¼Œè¦æ¯”å½“å‰æŸ¥çœ‹çš„è¿˜æ—©ä¸€ä¸ª
git diff <commit> <commit> xxx.java
# æŸ¥çœ‹ä¸¤ä¸ªåˆ†æ”¯çš„å…·ä½“å·®å¼‚
git diff dev st 


# ä¸€æ¬¡diffå‡ºå…¨éƒ¨modifyçš„æ–‡ä»¶å†…å®¹ ä¹Ÿå¯ä»¥è‡ªè¡Œé‡å®šå‘åˆ°æŸä¸ªæ–‡ä»¶ä¸­
git status | awk -F "modified:" '{if($2 != "") print $2}' | xargs git diff

# æŸ¥çœ‹å·²ç»commit ä½†æ˜¯æœªpushçš„è®°å½•
git cherry -v

# æŸ¥çœ‹æŸè¡Œæ–‡ä»¶ä¿®æ”¹äºº
git blame -L 58,100 filename
git blame -L 57,+10 filename
```

## æ’¤é”€ç±»å‘½ä»¤

```shell
# ä¸€æ¬¡æ’¤é”€æ‰€æœ‰çš„æ–‡ä»¶
git reset . 
git checkout .

r# æ’¤é”€æ‰modifyçŠ¶æ€
git checkout <filename>
# æ’¤é”€æ‰addçš„æ–‡ä»¶(å¦‚æœæ˜¯æ–°æ–‡ä»¶åˆ™æ˜¯untrackedçŠ¶æ€ å¦åˆ™æ˜¯modifyçŠ¶æ€)
git restore --staged test.txt
git rm --cached test.txt

# æ’¤é”€ add commit modify(æŠŠcommit è®°å½•å…¨åˆ æ‰ æ…ç”¨ï¼‰
git reset --hard <commit-id>
# æ’¤é”€addã€commit  (æŠŠcommit è®°å½•å˜æˆmodifyä¹‹åï¼‰
git reset --mixed <commit-id>
# ä»…æ’¤é”€commit (æŠŠcommit è®°å½•å˜æˆaddä¹‹åï¼‰
git reset --soft <commit-id>

# æ’¤é”€ä¸€æ¬¡æäº¤å†…å®¹
git revert <commit-id>git

# åˆ é™¤æœ¬åœ°æ‰€æœ‰ untracked è®°å½•
git clean -df
```

## åˆ›å»ºæˆ–åˆ é™¤ç›¸å…³å‘½ä»¤

```shell
# æœ¬åœ°ä»“åº“å…³è”åˆ°è¿œç¨‹ä»“åº“
git remote add origin git@github.com:whalefall541/rebase-learn.git
# åˆ é™¤å…³è”
git remote rm origin

# åˆ é™¤è¿œç¨‹ åˆ†æ”¯
git push origin -d <branch-name>

# åˆ›å»ºæœ¬åœ° åˆ†æ”¯
git branch <branch-name>
# åˆ›å»ºå¹¶åˆ‡æ¢
git chekcout -b <branch-name>
# åˆ é™¤æœ¬åœ° åˆ†æ”¯
git branch -D  <branch-name>
```

## åˆå¹¶ç±»å‘½ä»¤

```shell
# å…³é—­è‡ªåŠ¨åˆå¹¶
git merge --no-ff -m "merge with no-ff" dev

# è‡ªåŠ¨å˜åŸº åœ¨å½“å‰åˆ†æ”¯é‡æ”¾å¦ä¸€ä¸ªåˆ†æ”¯ 
git rebase [<branch-name> | <commit-id> | <head~n>]

# äº¤äº’å¼å˜åŸº
git rebase -i <commit-id> <commit-id> 

`ä¸€èˆ¬ä½¿ç”¨ p sç»„æˆ å°†å¤šæ¡commit åˆå¹¶ä¸ºä¸€æ¡` 
# æ³¨æ„ rebaseæ—¶commit id ä¸ºå‰å¼€åŒºé—´ï¼Œåé—­åŒºé—´ï¼›
# åƒä¸‡æ³¨æ„rebaseæ—¶åé¢çš„idè¦æ˜¯æœ€åä¸€ä¸ªï¼Œé™¤éä½ ä¸æƒ³è¦åœ¨åé¢idä¹‹åçš„æäº¤è®°å½•å¦åˆ™åƒä¸‡ä¸è¦è¿™ä¹ˆå¹²ï¼Œ
# å¦‚æœä¸å°å¿ƒåšäº†ï¼Œé‡æ–°ä»è¿œç¨‹æ‹‰å–æŠŠ

# Commands:
# p, pick <commit> = use commit
# r, reword <commit> = use commit, but edit the commit message
# e, edit <commit> = use commit, but stop for amending
# s, squash <commit> = use commit, but meld into previous commit
# f, fixup [-C | -c] <commit> = like "squash" but keep only the previous
#                    commit's log message, unless -C is used, in which case
#                    keep only this commit's message; -c is same as -C but
#                    opens the editor


# å°†baseåˆ†æ”¯çš„å†…å®¹å˜åŸºåˆ°å½“å‰åˆ†æ”¯ rebase å°±æ˜¯ç§»åŠ¨HEADæŒ‡é’ˆ
git rebase <base-branch>

ç¤ºä¾‹
A---B---C  main
         \
          D---E  feature

git checkout feature
git rebase main

A---B---C  main
             \
              D'--E'  feature

ã€Œæƒ³è¦è°â€œè·Ÿä¸Šâ€è°ï¼Œå°±åœ¨è°ä¸Šé¢æ‰§è¡Œ rebaseï¼Œç›®æ ‡æ˜¯â€œåŸºåº•â€ã€
â€œå¼€å‘ç”¨ rebaseï¼Œåˆå¹¶ç”¨ mergeï¼Œä¸»å¹²ä¸å¯ rebaseï¼Œå¹²å‡€ä¸å‡ºäº‹ã€‚â€

feature æƒ³è·Ÿä¸Š main â†’ åœ¨ feature ä¸Šæ‰§è¡Œ git rebase main

main æƒ³è·Ÿä¸Š featureï¼ˆä¸æ¨èï¼‰â†’ åœ¨ main ä¸Šæ‰§è¡Œ git rebase feature

# rebase --onto å¯ä»¥å°†ä¸€ä¸ªä½äºå­åˆ†æ”¯çš„åˆ†æ”¯å˜åŸºåˆ°ä¸»åˆ†æ”¯ä¸Š
# å˜åŸºå‰ï¼šcurrent-upsteam-branch æ˜¯base-branchçš„ä¸€ä¸ªå­åˆ†æ”¯ 
# è€Œ current-branch åˆæ˜¯ current-upsteam-branchçš„ä¸€ä¸ªå­åˆ†æ”¯
# å˜åŸºå current-upsteam-branch current-branch å„è‡ªä¸ºbase-branch çš„å­åˆ†æ”¯
# I.E. git rebase --onto
git rebase --onto <base-branch> <current-upsteam-branch> <current-branch>

ç¤ºä¾‹
A---B---C  main
         \
          D---E---F  feature
     \
      X---Y  experiment

git checkout experiment
git rebase --onto feature A

A---B---C  main
         \
          D---E---F  feature
                    \
                     X'--Y'  experiment
é€Ÿè®°ï¼š
å‰ªï¼šä» B å

è´´ï¼šåˆ° A å

æ“ä½œï¼š--onto A B

# ä»å…¶ä»–åˆ†æ”¯å¤åˆ¶æŸä¸ªæäº¤åˆ°å¦ä¸€ä¸ªåˆ†æ”¯
git cherry-pick <commit-id>
```

## æš‚å­˜å†…å®¹å‘½ä»¤

```shell
git stash
git stash list
git pop

# æš‚å­˜éƒ¨åˆ†æ–‡ä»¶
git stash push filename

# äº¤äº’å¼æš‚å­˜æ–‡ä»¶
git stash -p
```

å¦‚ä½•æš‚å­˜éƒ¨åˆ†æ–‡ä»¶å‘¢ [stash part][stash part]

[stash part]: https://www.jianshu.com/p/fe4d54cb6244

## æäº¤ç›¸å…³å‘½ä»¤

```shell
echo "# 123" >> README.md
git init
git add README.md
git commit -m "first commit"
# ä¿®æ”¹ä¸€ä¸‹HEADæŒ‡å‘çš„æ³¨é‡Š; notes: Donâ€™t amend public commits
git commit --amend -m "an updated commit message" --no-edit

git branch -M main
git remote add origin git@github.com:whalefall541/123.git
git push -u origin main

# ç›´æ¥åœ¨devåˆ†æ”¯ æ¨åˆ°æ‰€æœ‰å…¶ä»–åˆ†æ”¯ ä»branch1åˆ†æ”¯æ¨é€åˆ°branch2
git push origin refs/heads/branch1:branch2
```

## æ ‡ç­¾ç±»å‘½ä»¤

```shell
# åœ¨å½“å‰åˆ†æ”¯å½“å‰æäº¤ä¸Šæ‰“æ ‡ç­¾ï¼š
git tag v1.0

#å¦‚æœæƒ³è¦æ‰“æ ‡ç­¾åœ¨æŸä¸ªæŒ‡å®šå†å²commitä¸Šï¼š
git tag v0.9 f52c633
git tag -a <tagname> -m "<message>"

# å¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ä¸€ä¸ªtagä¿¡æ¯ï¼š
git show v0.1

# å¦‚æœæ ‡ç­¾æ‰“é”™äº†ï¼Œä¹Ÿå¯ä»¥åˆ é™¤ï¼š
git tag -d v0.1

# å¦‚æœè¦æ¨é€æŸä¸ªæ ‡ç­¾åˆ°è¿œç¨‹ï¼Œä½¿ç”¨å‘½ä»¤git push origin <tagname>
git push origin v1.0
# æˆ–è€…ï¼Œä¸€æ¬¡æ€§æ¨é€å…¨éƒ¨å°šæœªæ¨é€åˆ°è¿œç¨‹çš„æœ¬åœ°æ ‡ç­¾ï¼š
git push origin --tags    
# å¦‚æœæ ‡ç­¾å·²ç»æ¨é€åˆ°è¿œç¨‹ï¼Œè¦åˆ é™¤è¿œç¨‹æ ‡ç­¾å°±éº»çƒ¦ä¸€ç‚¹ï¼Œå…ˆä»æœ¬åœ°åˆ é™¤ï¼š
git tag -d v0.9    
# ç„¶åï¼Œä»è¿œç¨‹åˆ é™¤ã€‚åˆ é™¤å‘½ä»¤ä¹Ÿæ˜¯pushï¼Œä½†æ˜¯æ ¼å¼å¦‚ä¸‹ï¼š
git push origin :refs/tags/v0.9
```

## æ›´æ–°å‘½ä»¤

[å¯ä»¥å‚è€ƒè¿™ä¸ªç½‘ç«™](https://cloud.tencent.com/developer/section/1138793)

```shell
# æ‹‰å–æ‰€æœ‰åˆ†æ”¯
git fetch --all
# updateæŸä¸ªåˆ†æ”¯ å¦‚æœæ˜¯èšåˆå·¥ç¨‹éœ€è¦åŠ ä¸Š--recurse-submodules=no 
git fetch origin main:main --progress --prune
 
# æ‹‰å–ä»£ç æ—¶å˜åŸº fetch and rebase 
git pull -r origin main

git fetch origin 
git pull 

git pull -r

```

## å¦‚ä½•åŒæ­¥github forkä»“åº“

1. é…ç½®forkedä»“åº“
   [configuring-a-remote-for-a-fork](https://docs.github.com/en/github/collaborating-with-pull-requests/working-with-forks/configuring-a-remote-for-a-fork)
2. Merging an upstream repository into your fork
   [syncing-a-fork](https://docs.github.com/en/github/collaborating-with-pull-requests/working-with-forks/syncing-a-fork)


## åŸåˆ™é—®é¢˜

1. git rebase åŸåˆ™ï¼šåŒæ­¥å¹¶ä¿æŒå†å²æ•´æ´ï¼š

âœ… ç”¨äºå°†å½“å‰åˆ†æ”¯çš„æ›´æ”¹ï¼Œè½¬ç§»åˆ°ç›®æ ‡åˆ†æ”¯çš„æœ€æ–°çŠ¶æ€ä¹‹å

âœ… ä¿æŒçº¿æ€§æäº¤å†å²ï¼Œé¿å…åˆå¹¶å†²çªæ ‘

âœ… æ›´é€‚åˆ feature åˆ†æ”¯åŒæ­¥ä¸»å¹²ï¼šgit rebase main

âš ï¸ ä½¿ç”¨å‰è¯·ç¡®ä¿å·¥ä½œåŒºå¹²å‡€ï¼ˆgit status åº”æ— æ”¹åŠ¨ï¼‰

âŒ ä¸å»ºè®®å¯¹å…±äº«å†å²çš„åˆ†æ”¯å¼ºæ¨ï¼ˆé™¤éå›¢é˜Ÿå…è®¸ï¼‰

2. git pull --rebase åŸåˆ™ï¼šç®€åŒ– fetch + rebase
âœ… æ˜¯ git fetch + git rebase çš„å¿«æ·æ–¹å¼

âœ… æ¨èè®¾ä¸ºé»˜è®¤ç­–ç•¥ï¼Œé¿å…äº§ç”Ÿ merge commit

3. åˆ†æ”¯åŒæ­¥æ¨èæ¨¡å¼ï¼ˆåŒå‘åŒæ­¥åœºæ™¯ï¼‰
å‡è®¾ä½ åœ¨ dev å’Œ feature-x ä¸¤ä¸ªåˆ†æ”¯é—´äº¤æ›¿å¼€å‘ï¼š

ğŸ” åŒæ­¥ä¸»å¹²è¿› feature åˆ†æ”¯ï¼š

git checkout feature-x

git fetch origin

git rebase origin/dev  # æˆ– git rebase dev

â¬†ï¸ å°† feature-x å›åŒæ­¥å› devï¼š

git checkout dev

git rebase feature-x  # æˆ–è€… git merge --ff-only feature-x

âš ï¸ å¦‚æœå›¢é˜Ÿå…±äº« devï¼Œå»ºè®®ä½¿ç”¨ merge ä»¥å…å¼ºåˆ¶æ¨é€

## ç¢°åˆ°é—®é¢˜è®°å½•

### åœºæ™¯åœ¨IDEAä¸­PS terminalä¸­ä½¿ç”¨`git rebase -i`æ—¶æ— æ³•é€€å‡º

If `rebase -i` , vim exit exceptionally

**Do not close terminal directly,  press `esc` and input `:q!` .**

**The first way**

I understand this is frustrating. Let's try a more comprehensive approach to recover your repository:

1. Let's first check the overall Git status:
    
    ```
    git status
    
    ```
    
2. If the above command still shows errors, let's try a full reset using ORIG_HEAD:
    
    ```
    git reset --hard ORIG_HEAD
    
    ```
    
3. If that doesn't work, we can try checking what branches exist:
    
    ```
    git branch -a
    
    ```
    
4. Then try to get back to your main/master branch:
    
    ```
    git checkout main
    
    ```
    
    (or `git checkout master` if that's your primary branch name)
    
5. If all else fails, we might need a more drastic approach. First, back up any uncommitted changes you care about manually. Then:
    
    ```
    # Create or update a reference to your current HEAD
    git update-ref HEAD $(git rev-parse HEAD) 2>/dev/null
    
    # Clean up all Git temporary files
    rm -f .git/MERGE_HEAD .git/MERGE_MODE .git/MERGE_MSG
    rm -rf .git/rebase-merge .git/rebase-apply
    
    # Reset the index and working tree
    git reset --hard
    
    ```
    

If none of these approaches work, please let me know what specific error messages you're seeing now, and we can try a different recovery method.

**the second way**

firstly push the local commit to the remote, even though your broken repository in rebase status.

secondly clone a new copy repository to a different directory, then open with the idea

if idea occurs Cannot resolve symbol â€˜xxxâ€™, just Invalidate caches and restart the project, project will run normally.


import TailProtocal from "@site/src/components/TailProtocal";

<TailProtocal />
