"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5074],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>k});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var c=r.createContext({}),s=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},d=function(e){var n=s(e.components);return r.createElement(c.Provider,{value:n},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=s(t),u=o,k=p["".concat(c,".").concat(u)]||p[u]||m[u]||a;return t?r.createElement(k,i(i({ref:n},d),{},{components:t})):r.createElement(k,i({ref:n},d))}));function k(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,i=new Array(a);i[0]=u;var l={};for(var c in n)hasOwnProperty.call(n,c)&&(l[c]=n[c]);l.originalType=e,l[p]="string"==typeof e?e:o,i[1]=l;for(var s=2;s<a;s++)i[s]=t[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},4668:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>m,frontMatter:()=>a,metadata:()=>l,toc:()=>s});var r=t(7462),o=(t(7294),t(3905));const a={},i=void 0,l={unversionedId:"Container-Tech/docker/idea \u90e8\u7f72",id:"Container-Tech/docker/idea \u90e8\u7f72",title:"idea \u90e8\u7f72",description:"idea\u4f7f\u7528docker\u90e8\u7f72",source:"@site/docs/Container-Tech/docker/idea \u90e8\u7f72.md",sourceDirName:"Container-Tech/docker",slug:"/Container-Tech/docker/idea \u90e8\u7f72",permalink:"/summary/Container-Tech/docker/idea \u90e8\u7f72",draft:!1,editUrl:"https://github.com/Halcyon666/summary/blob/main/docs/Container-Tech/docker/idea \u90e8\u7f72.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"docker \u914d\u7f6e\u56fd\u5185\u955c\u50cf\u5730\u5740",permalink:"/summary/Container-Tech/docker/docker-\u914d\u7f6e\u56fd\u5185\u955c\u50cf\u5730\u5740"},next:{title:"CentOS8\u5b89\u88c5K8S",permalink:"/summary/Container-Tech/kubernetes/CentOS8\u5b89\u88c5K8S"}},c={},s=[{value:"idea\u4f7f\u7528docker\u90e8\u7f72",id:"idea\u4f7f\u7528docker\u90e8\u7f72",level:2},{value:"linux\u4e2ddocker\u914d\u7f6e",id:"linux\u4e2ddocker\u914d\u7f6e",level:3},{value:"IDEA \u914d\u7f6e\u622a\u56fe",id:"idea-\u914d\u7f6e\u622a\u56fe",level:3},{value:"DockerFile",id:"dockerfile",level:3},{value:"dockerfile.run.xml",id:"dockerfilerunxml",level:3},{value:"idea\u4f7f\u7528docker-compose\u90e8\u7f72",id:"idea\u4f7f\u7528docker-compose\u90e8\u7f72",level:2},{value:"docker-compose.yml",id:"docker-composeyml",level:3},{value:"\u4e0b\u8f7ddocker-compose",id:"\u4e0b\u8f7ddocker-compose",level:3},{value:"\u8bbf\u95ee",id:"\u8bbf\u95ee",level:2}],d={toc:s},p="wrapper";function m(e){let{components:n,...t}=e;return(0,o.kt)(p,(0,r.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"idea\u4f7f\u7528docker\u90e8\u7f72"},"idea\u4f7f\u7528docker\u90e8\u7f72"),(0,o.kt)("h3",{id:"linux\u4e2ddocker\u914d\u7f6e"},"linux\u4e2ddocker\u914d\u7f6e"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl disable firewalld --now\nsetenforce 0\nsed  -i -r 's/SELINUX=[ep].*/SELINUX=disabled/g' /etc/selinux/config\nswapoff -a\nsed -i '/swap/s/^\\(.*\\)$/#\\1/g' /etc/fstab\n\ncat <<EOF > /usr/lib/systemd/system/docker.service\n[Unit]\nDescription=Docker Application Container Engine\nDocumentation=https://docs.docker.com\nAfter=network-online.target firewalld.service containerd.service\nWants=network-online.target\nRequires=docker.socket containerd.service\n\n[Service]\nType=notify\n# the default is not to use systemd for cgroups because the delegate issues still\n# exists and systemd currently does not support the cgroup feature set required\n# for containers run by docker\nExecStart=/usr/bin/dockerd -H fd:// -H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock --containerd=/run/containerd/containerd.sock\nExecReload=/bin/kill -s HUP $MAINPID\nTimeoutSec=0\nRestartSec=2\nRestart=always\n\n# Note that StartLimit* options were moved from \"Service\" to \"Unit\" in systemd 229.\n# Both the old, and new location are accepted by systemd 229 and up, so using the old location\n# to make them work for either version of systemd.\nStartLimitBurst=3\n\n# Note that StartLimitInterval was renamed to StartLimitIntervalSec in systemd 230.\n# Both the old, and new name are accepted by systemd 230 and up, so using the old name to make\n# this option work for either version of systemd.\nStartLimitInterval=60s\n\n# Having non-zero Limit*s causes performance problems due to accounting overhead\n# in the kernel. We recommend using cgroups to do container-local accounting.\nLimitNOFILE=infinity\nLimitNPROC=infinity\nLimitCORE=infinity\n\n# Comment TasksMax if your systemd version does not support it.\n# Only systemd 226 and above support this option.\nTasksMax=infinity\n\n# set delegate yes so that systemd does not reset the cgroups of docker containers\nDelegate=yes\n\n# kill only the docker process, not all processes in the cgroup\nKillMode=process\nOOMScoreAdjust=-500\n\n[Install]\nWantedBy=multi-user.target\nEOF\n")),(0,o.kt)("h3",{id:"idea-\u914d\u7f6e\u622a\u56fe"},"IDEA \u914d\u7f6e\u622a\u56fe"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://s2.loli.net/2023/07/15/zYjAySuVTmbNCG1.png",alt:"image-20230519011746636"})),(0,o.kt)("hr",null),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://s2.loli.net/2023/07/15/MuEtIrFQCgDplvK.png",alt:"image-20230519011658616"})),(0,o.kt)("h3",{id:"dockerfile"},"DockerFile"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-dockerfile"},'FROM openjdk:8u342-jdk\n\nWORKDIR /deployment\n\n# \u5c06\u5f53\u524d\u76ee\u5f55\u4e0b\u7684jar\u5305\u590d\u5236\u5230docker\u5bb9\u5668\u7684/\u76ee\u5f55\u4e0b\nADD ./target/learncases-0.0.1-SNAPSHOT.jar app.jar\nRUN jar -xvf app.jar && rm -f app.jar\n# \u58f0\u660e\u670d\u52a1\u8fd0\u884c\u57288080\u7aef\u53e3\nEXPOSE 8080\n# \u6307\u5b9adocker\u5bb9\u5668\u542f\u52a8\u65f6\u8fd0\u884cjar\u5305\nENTRYPOINT ["java","-cp","/deployment","-DSpring.profiles.active=default","org.springframework.boot.loader.JarLauncher"]\n\n')),(0,o.kt)("h3",{id:"dockerfilerunxml"},"dockerfile.run.xml"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'\n<component name="ProjectRunConfigurationManager">\n  <configuration default="false" name="dockerfile" type="docker-deploy" factoryName="dockerfile" editBeforeRun="true" singleton="false" server-name="Docker">\n    <deployment type="dockerfile">\n      <settings>\n        <option name="imageTag" value="learncase" />\n        <option name="containerName" value="learncase" />\n        <option name="portBindings">\n          <list>\n            <DockerPortBindingImpl>\n              <option name="containerPort" value="8080" />\n              <option name="hostIp" value="192.168.3.163" />\n              <option name="hostPort" value="8080" />\n            </DockerPortBindingImpl>\n          </list>\n        </option>\n        <option name="sourceFilePath" value="dockerfile" />\n      </settings>\n    </deployment>\n    <method v="2">\n      <option name="Maven.BeforeRunTask" enabled="true" file="$PROJECT_DIR$/pom.xml" goal="clean package" />\n    </method>\n  </configuration>\n</component>\n')),(0,o.kt)("h2",{id:"idea\u4f7f\u7528docker-compose\u90e8\u7f72"},"idea\u4f7f\u7528docker-compose\u90e8\u7f72"),(0,o.kt)("h3",{id:"docker-composeyml"},"docker-compose.yml"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yml"},'version: \'2\'\nservices:\n  learn-cases1:\n    container_name: learn-cases1\n    build:\n      context: .\n      dockerfile: Dockerfile\n    image: learncase:latest\n    ports:\n      - "8080:8080"\n  learn-cases2:\n    container_name: learn-cases2\n    build:\n      context: .\n      dockerfile: Dockerfile\n    image: learncase:latest\n# \u5916\u90e8\u7aef\u53e38081 \u5bb9\u5668\u7aef\u53e38080\n    ports:\n      - "8081:8080"\n  learn-cases3:\n    container_name: learn-cases3\n    build:\n      context: .\n      dockerfile: Dockerfile\n    image: learncase:latest\n    ports:\n      - "8082:8080"\n\n')),(0,o.kt)("h3",{id:"\u4e0b\u8f7ddocker-compose"},"\u4e0b\u8f7ddocker-compose"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://github.com/docker/compose/releases"},"\u4e0b\u8f7d\u5730\u5740")),(0,o.kt)("p",null,"\u914d\u7f6eDocker Compose executable \u5373\u53ef"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://s2.loli.net/2023/07/15/m1OAeNiE9ZsCqGX.png",alt:"image-20230519222216138"})),(0,o.kt)("hr",null),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://s2.loli.net/2023/07/15/BpjWZl64f2wHQyJ.png",alt:"image-20230520001747099"})),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u6ce8\u610f\u90e8\u7f72\u65f6\u76f4\u63a5run \u53ef\u80fd\u6ca1\u6709\u62c9\u8d77\u4e09\u4e2acontaner,\u8fd9\u4e2a\u65f6\u5019\u53ef\u4ee5\u5148down \u7136\u540e\u518ddeploy")),(0,o.kt)("h2",{id:"\u8bbf\u95ee"},"\u8bbf\u95ee"),(0,o.kt)("p",null,"192.168.3.163:8080"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://s2.loli.net/2023/07/15/azqiL7VdEQXxYtC.png",alt:"image-20230705233312670"})))}m.isMDXComponent=!0}}]);