"use strict";(self.webpackChunksummary=self.webpackChunksummary||[]).push([["5663"],{41297:function(n,e,t){t.r(e),t.d(e,{frontMatter:()=>c,toc:()=>l,default:()=>g,metadata:()=>r,assets:()=>p,contentTitle:()=>a});var r=JSON.parse('{"id":"Java/Spring/AspectJ AOP","title":"AspectJ\u5F62\u5F0FAOP\u4F7F\u7528","description":"\u672C\u6587\u76F8\u5173\u4EE3\u7801(\u6765\u81EA\u5B98\u65B9\u6E90\u7801spring-test\u6A21\u5757)\u8BF7\u53C2\u89C1spring-framework org.springframework.mylearntest\u5305\u4E0B\u3002","source":"@site/docs/01-Java/02-Spring/13-AspectJ AOP.mdx","sourceDirName":"01-Java/02-Spring","slug":"/Java/Spring/AspectJ AOP","permalink":"/summary/Java/Spring/AspectJ AOP","draft":false,"unlisted":false,"editUrl":"https://github.com/Halcyon666/summary/edit/main/docs/01-Java/02-Spring/13-AspectJ AOP.mdx","tags":[],"version":"current","lastUpdatedBy":"Halcyon666","lastUpdatedAt":1760881989000,"sidebarPosition":13,"frontMatter":{"title":"AspectJ\u5F62\u5F0FAOP\u4F7F\u7528","sidebar_label":"AspectJ\u5F62\u5F0FAOP\u4F7F\u7528"},"sidebar":"tutorialSidebar","previous":{"title":"Spring AOP\u7684\u7EC7\u51652","permalink":"/summary/Java/Spring/Spring AOP Woven2"},"next":{"title":"\u57FA\u4E8ESchema\u7684AOPA\u914D\u7F6E","permalink":"/summary/Java/Spring/AOP Configuration of Schema"}}'),i=t(47259),o=t(55511),s=t(60145);let c={title:"AspectJ\u5F62\u5F0FAOP\u4F7F\u7528",sidebar_label:"AspectJ\u5F62\u5F0FAOP\u4F7F\u7528"},a,p={},l=[{value:"\u4E24\u79CD\u7EC7\u5165Aspect\u65B9\u6CD5",id:"\u4E24\u79CD\u7EC7\u5165aspect\u65B9\u6CD5",level:2},{value:"\u7F16\u7A0B\u65B9\u5F0F\u7EC7\u5165",id:"\u7F16\u7A0B\u65B9\u5F0F\u7EC7\u5165",level:3},{value:"\u901A\u8FC7\u81EA\u52A8\u4EE3\u7406\u7EC7\u5165",id:"\u901A\u8FC7\u81EA\u52A8\u4EE3\u7406\u7EC7\u5165",level:3},{value:"@AspectJ\u5F62\u5F0F\u7684Pointcut",id:"aspectj\u5F62\u5F0F\u7684pointcut",level:2},{value:"@AspectJ\u5F62\u5F0FPointcut\u58F0\u660E\u65B9\u5F0F",id:"aspectj\u5F62\u5F0Fpointcut\u58F0\u660E\u65B9\u5F0F",level:3},{value:"AspectJ\u5F62\u5F0FPointcut\u8868\u8FBE\u5F0F\u7684\u6807\u8BC6\u7B26",id:"aspectj\u5F62\u5F0Fpointcut\u8868\u8FBE\u5F0F\u7684\u6807\u8BC6\u7B26",level:3},{value:"execution",id:"execution",level:4},{value:"within",id:"within",level:4},{value:"this\u548Ctarget",id:"this\u548Ctarget",level:4},{value:"args",id:"args",level:4},{value:"annotation",id:"annotation",level:4},{value:"@AspectJ\u5F62\u5F0F\u7684Advice",id:"aspectj\u5F62\u5F0F\u7684advice",level:2},{value:"Spring 2.0 \u57FA\u4E8EXSD\u5404\u79CDAdvice\u7684\u914D\u58F0\u660E\u65B9\u5F0F",id:"spring-20-\u57FA\u4E8Exsd\u5404\u79CDadvice\u7684\u914D\u58F0\u660E\u65B9\u5F0F",level:4},{value:"Introduction",id:"introduction",level:4},{value:"Advice\u7684\u6267\u884C\u987A\u5E8F",id:"advice\u7684\u6267\u884C\u987A\u5E8F",level:4},{value:"Aspect\u7684\u5B9E\u4F8B\u5316\u6A21\u5F0F",id:"aspect\u7684\u5B9E\u4F8B\u5316\u6A21\u5F0F",level:3}];function d(n){let e={a:"a",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...n.components},{Details:t}=e;return t||function(n,e){throw Error("Expected "+(e?"component":"object")+" `"+n+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(e.p,{children:["\u672C\u6587\u76F8\u5173\u4EE3\u7801(\u6765\u81EA",(0,i.jsx)(e.a,{href:"https://github.com/spring-projects/spring-framework.git",title:"\u5B98\u65B9\u6E90\u7801",children:"\u5B98\u65B9\u6E90\u7801"}),"spring-test\u6A21\u5757)\u8BF7\u53C2\u89C1",(0,i.jsx)(e.a,{href:"https://github.com/Halcyon666/spring-framework-modified/tree/main/spring-test",children:"spring-framework"})," org.springframework.mylearntest\u5305\u4E0B\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u65E0\u9700\u50CF1.0\u90A3\u6837\u5B9E\u73B0\u76F8\u5E94\u7684\u63A5\u53E3\uFF0C\u552F\u4E00\u8981\u505A\u7684\u5C31\u662F\u5728\u8FD9\u4E2AAspect\u7C7B\u4E0A\u52A0\u4E00\u4E2A@Aspect\u6CE8\u89E3\u3002\u8FD9\u6837\u5C31\u53EF\u4EE5\u5224\u65ADClassPath\u4E2D\u54EA\u4E9B\u7C7B\u662F\u6211\u4EEC\u8981\u627E\u7684Aspect\u5B9A\u4E49\u3002\u901A\u8FC7@Pointcut\u5B9A\u4E49Pointcut\uFF0C\u901A\u8FC7Around\u7B49\u6CE8\u89E3\u6765\u6307\u5B9A\u54EA\u4E9B\u65B9\u6CD5\u5B9A\u4E49\u4E86\u76F8\u5E94\u7684Advice\u903B\u8F91\u3002"}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:"PerformanceTraceAspect"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'package org.springframework.mylearntest.aop2.aspectj;\n\nimport org.apache.commons.lang3.time.StopWatch;\nimport org.apache.commons.logging.Log;\nimport org.apache.commons.logging.LogFactory;\nimport org.aspectj.lang.ProceedingJoinPoint;\nimport org.aspectj.lang.annotation.Around;\nimport org.aspectj.lang.annotation.Aspect;\nimport org.aspectj.lang.annotation.Pointcut;\n\n/**\n * @Author: whalefall\n * @Date: 2020/7/28 22:46\n * Spring 2.0 \u4E4B\u540E\u65E0\u9700\u5B9E\u73B0\u63A5\u53E3\u5B9A\u4E49pointcut\n */\n@Aspect\npublic class PerformanceTraceAspect {\n	private final Log logger = LogFactory.getLog(PerformanceTraceAspect.class);\n\n	@Pointcut("execution(public  void *.method1()) || execution(public  void *.method2())")\n	public void pointcutName() {}\n\n	@Around("pointcutName()")\n	public Object performanceTrace(ProceedingJoinPoint joinPoint) throws Throwable {\n		StopWatch sw = new StopWatch();\n		try {\n			sw.start();\n			return joinPoint.proceed();\n		} finally {\n				System.out.println("pt in method["\n						+ joinPoint.getSignature().getName()\n				+ "]>>>>>>" + sw.toString());\n		}\n	}\n}\n'})})]}),"\n",(0,i.jsx)(e.h2,{id:"\u4E24\u79CD\u7EC7\u5165aspect\u65B9\u6CD5",children:"\u4E24\u79CD\u7EC7\u5165Aspect\u65B9\u6CD5"}),"\n",(0,i.jsx)(e.p,{children:"\u5047\u5982\u6211\u4EEC\u6709\u4E00\u4E2A\u76EE\u6807\u5BF9\u8C61Foo\uFF0C\u6709\u4E24\u79CD\u65B9\u5F0F\u5C06Aspect\u5B9A\u4E49\u7EC7\u5165\u8FD9\u4E2A\u76EE\u6807\u5BF9\u8C61\u7C7B\uFF0C\uFF0C\u5B9E\u73B0\u5BF9\u5176\u7B26\u5408Pointcut\u5B9A\u4E49\u7684Joinpoint\u8FDB\u884C\u62E6\u622A\u3002"}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:"Foo"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class Foo {\n	public void method1() {\n		System.out.println("method1 executed");\n	}\n\n	public void method2() {\n		System.out.println("method2 executed");\n	}\n}\n'})})]}),"\n",(0,i.jsx)(e.h3,{id:"\u7F16\u7A0B\u65B9\u5F0F\u7EC7\u5165",children:"\u7F16\u7A0B\u65B9\u5F0F\u7EC7\u5165"}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:"\u901A\u8FC7AspectJProxyFactory\u5B9E\u73B0"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class Test4AspectJProxyFactory {\n	public static void main(String[] args) {\n		AspectJProxyFactory weaver = new AspectJProxyFactory();\n		weaver.setProxyTargetClass(true);\n		weaver.setTarget(new Foo());\n		weaver.addAspect(PerformanceTraceAspect.class);\n		Object proxy = weaver.getProxy();\n		((Foo)proxy).method1();\n		((Foo)proxy).method2();\n	}\n}\n"})})]}),"\n",(0,i.jsx)(e.h3,{id:"\u901A\u8FC7\u81EA\u52A8\u4EE3\u7406\u7EC7\u5165",children:"\u901A\u8FC7\u81EA\u52A8\u4EE3\u7406\u7EC7\u5165"}),"\n",(0,i.jsx)(e.p,{children:"\u9488\u5BF9@AspectJ\u98CE\u683C\u7684AOP\uFF0CSpring AOP\u4E13\u95E8\u63D0\u4F9B\u4E86\u4E00\u4E2AAutoProxyCreator\u5B9E\u73B0\u7C7B\u8FDB\u884C\u81EA\u52A8\u4EE3\u7406\uFF0C\u4EE5\u514D\u53BB\u8FC7\u591A\u7684\u7F16\u7801\u548C\u914D\u7F6E\u5DE5\u4F5C\uFF0C\u5B83\u662F\u5728AbstractAdvisorAutoProxyCreator\u57FA\u7840\u4E0A\u7684\u4E00\u4E2A\u6269\u5C55\u7C7B\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u4E0EAutoProxyCreator\u4E00\u6837\uFF0C\u6211\u4EEC\u9700\u8981\u5728IoC\u5BB9\u5668\u7684\u914D\u7F6E\u6587\u4EF6\u4E2D\u6CE8\u518C\u4E00\u4E0BAnnotationAwareAspectJAutoProxyCreator\u5C31\u53EF\u4EE5\u4E86\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://s2.loli.net/2023/07/15/hrGdFWtgxbfa78l.png",alt:""})}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:"xml \u914D\u7F6E"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<beans xmlns="http://www.springframework.org/schema/beans"\n	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n	   xmlns:aop="http://www.springframework.org/schema/aop"\n	   xsi:schemaLocation="http://www.springframework.org/schema/beans\n		http://www.springframework.org/schema/beans/spring-beans-2.5.xsd\n\n		 http://www.springframework.org/schema/aop https://www.springframework.org/schema/aop/spring-aop.xsd">\n\n	<aop:aspectj-autoproxy proxy-target-class="true"/>\n	\x3c!--	\u7B49\u540C\u4E8E\u4E0A\u9762\u4E00\u884C--\x3e\n	\x3c!--<bean class="org.springframework.aop.aspectj.annotation.AnnotationAwareAspectJAutoProxyCreator">\n		<property name="proxyTargetClass" value="true"/>\n	</bean>--\x3e\n\n	<bean id="performanceAspect" class="org.springframework.mylearntest.aop2.aspectj.PerformanceTraceAspect"/>\n\n	<bean id="target" class="org.springframework.mylearntest.aop2.aspectj.Foo"/>\n</beans>\n'})})]}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:"TestAutoAspectJ"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class Test4AutoAspectJ {\n	public static void main(String[] args) {\n		ApplicationContext context = new ClassPathXmlApplicationContext("annotationawareaspectJautoproxycreator\\\\annotationawareaspectJautoproxycreator.xml");\n		Object proxy = context.getBean("target");\n		((Foo)proxy).method1();\n		((Foo)proxy).method2();\n	}\n}\n'})})]}),"\n",(0,i.jsx)(e.p,{children:"\u5982\u679C\u628Atarget\u4F5C\u4E3A\u4F9D\u8D56\u5BF9\u8C61\u6CE8\u5165\u5176\u4ED6\u7684bean\u5B9A\u4E49\uFF0C\u90A3\u4E48\u4F9D\u8D56\u7684\u4E3B\u4F53\u5BF9\u8C61\u5728\u6301\u6709\u7684\u4E5F\u662F\u88AB\u4EE3\u7406\u8FC7\u7684\u76EE\u6807\u5BF9\u8C61\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Tip"})}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"\u5728\u4F7F\u7528@AspectJ\u5F62\u5F0F\u7684AOP\u7684\u65F6\u5019\uFF0C\u5E94\u8BE5\u5C3D\u91CF\u4F7F\u7528\u5BB9\u5668\u5185\u7684\u81EA\u52A8\u4EE3\u7406\u652F\u6301\uFF0C\u901A\u5E38\uFF0C\u53EA\u6709\u5904\u4E8E\u6D4B\u8BD5\u76EE\u7684\u624D\u4F1A\u4F7F\u7528\u7F16\u7A0B\u7684\u65B9\u5F0F\u76F4\u63A5\u7EC7\u5165\u64CD\u4F5C\uFF0C\u5728\u4F7F\u7528\u8FC7\u7A0B\u4E2D\uFF0C\u4F60\u4F1A\u53D1\u73B0\uFF0C\u5B9E\u9645\u4E0A\u8FD9\u4E24\u79CD\u65B9\u5F0F\u662F\u6709\u5DEE\u5F02\u7684\uFF0C\u4E00\u4E9B\u884C\u4E3A\u5E76\u4E0D\u7EDF\u4E00\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u4F7F\u7528@Aspect\u5F62\u5F0F\u7684AOP\uFF0C\u9700\u8981\u5F15\u5165aspectjweaver.jar\u548Caspectjrt.jar\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"aspectj\u5F62\u5F0F\u7684pointcut",children:"@AspectJ\u5F62\u5F0F\u7684Pointcut"}),"\n",(0,i.jsx)(e.p,{children:"\u5728Spring\u6846\u67B6\u53D1\u5E03 2.0 \u7248\u672C\u4E4B\u524D\uFF0CSpring AOP\u6CA1\u6709\u50CFAspectJ\u90A3\u6837\u7684\u6B63\u5F0F\u7684Pointcut\u63CF\u8FF0\u8BED\u8A00\uFF0C\u800C\u4E14\u4E5F\u53EA\u652F\u6301\u65B9\u6CD5\u7EA7\u522B\u7684\u62E6\u622A\u3002\u6240\u4EE5\u901A\u5E38\u60C5\u51B5\u4E0B\uFF0C\u7B80\u5355\u7684\u65B9\u6CD5\u540D\u6307\u5B9A\u4EE5\u53CA\u6B63\u5219\u8868\u8FBE\u5F0F\u4E24\u79CD\uFF0C\u57FA\u672C\u4E0A\u53EF\u4EE5\u5F88\u597D\u5730\u8FBE\u5230\u76EE\u7684\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u5728Spring\u53D1\u5E03 2.0 \u7248\u672C\u4E4B\u540E\uFF0CSpring AOP \u6846\u67B6\u96C6\u6210\u4E86AspectJ\u7684\u90E8\u5206\u529F\u80FD\uFF0C\u8FD9\u5176\u4E2D\u5C31\u5305\u62ECAspectJ\u7684Pointcut\u8BED\u8A00\u652F\u6301\u3002\u4ECEDTD\u8FC7\u6E21\u5230XSD\u65F6\u4EE3\u3002"}),"\n",(0,i.jsx)(e.h3,{id:"aspectj\u5F62\u5F0Fpointcut\u58F0\u660E\u65B9\u5F0F",children:"@AspectJ\u5F62\u5F0FPointcut\u58F0\u660E\u65B9\u5F0F"}),"\n",(0,i.jsx)(e.p,{children:"@AspectJ\u5F62\u5F0F\u7684Pointcut\u58F0\u660E\uFF0C\u4F9D\u9644\u5728@ApectJ\uFF0C\u901A\u8FC7\u4F7F\u7528org.aspectj.lang.annotation.Pointcut\u8FD9\u4E2A\u6CE8\u89E3\uFF0C\u6307\u5B9AAspectJ\u5F62\u5F0F\u7684Pointcut\n\u8868\u8FBE\u5F0F\u4E4B\u540E\uFF0C\u5C06\u8FD9\u4E2A\u6307\u5B9A\u4E86\u76F8\u5E94\u8868\u8FBE\u5F0F\u7684\u6CE8\u89E3\u6807\u6CE8\u5230Aspect\u5B9A\u4E49\u7C7B\u7684\u67D0\u4E2A\u65B9\u6CD5\u4E0A\u5373\u53EF\u3002"}),"\n",(0,i.jsx)(e.p,{children:"@AspectJ\u5F62\u5F0F\u7684Pointcut\u58F0\u660E\u5305\u542B\u5982\u4E0B\u4E24\u4E2A\u90E8\u5206\u3002"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Pointcut Expression"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.em,{children:"Pointcut Expression\u7684\u8F7D\u4F53\u4E3A@Pointcut\uFF0C\u8BE5\u6CE8\u89E3\u662F\u65B9\u6CD5\u7EA7\u522B\u7684\u6CE8\u89E3\uFF0C\u6240\u4EE5Pointcut Expression\u4E0D\u80FD\u8131\u79BB\u67D0\u4E2A\u65B9\u6CD5\u5355\u72EC\u58F0\u660E"})}),"\n",(0,i.jsx)(e.p,{children:"\u8868\u8FBE\u5F0F\u7531\u4E24\u90E8\u5206\u7EC4\u6210\uFF0C\u5206\u522B\u662FPointcut\u6807\u8BC6\u7B26\uFF0C\u548C\u8868\u8FBE\u5F0F\u5339\u914D\u6A21\u5F0F\u3002"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Pointcut Signature"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5B83\u662F\u4E00\u4E2A\u65B9\u6CD5\u7684\u5B9A\u4E49\uFF0C\u4F5C\u4E3APointcut Expression\u7684\u8F7D\u4F53\u3002Pointcut Signature\u6240\u5728\u7684\u65B9\u6CD5\u5B9A\u4E49\uFF0C\u9664\u4E86\u8FD4\u56DE\u7C7B\u578B\u5FC5\u987B\u662Fvoid\u4E4B\u5916\uFF0C\u6CA1\u6709\u5176\u4ED6\u7684\u9650\u5236\u3002\u65B9\u6CD5\u4FEE\u9970\u7B26\u6240\u8D77\u5230\u7684\u4F5C\u7528\u4E8Ejava\u8BED\u8A00\u4E2D\u8BED\u4E49\u76F8\u540C\uFF0Cpublic\u578B\u7684Pointcut Signature\u53EF\u4EE5\u5728\u5176\u4ED6Aspect\u5B9A\u4E49\u4E2D\u5F15\u7528\uFF0Cprivate\u5219\u53EA\u80FD\u5728\u5F53\u524DAspect\u5B9A\u4E49\u4E2D\u5F15\u7528\u3002\u53EF\u4EE5\u5C06Pointcut Signature\u4F5C\u4E3A\u76F8\u5E94Pointcut Expression\u7684\u6807\u8BC6\u7B26\uFF0C\u5728Pointcut Expression\u7684\u5B9A\u4E49\u4E2D\u53D6\u4EE3\u91CD\u590D\u7684Pointcut\u8868\u8FBE\u5F0F\u5B9A\u4E49\u3002"}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:"YourAspect"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Aspect\npublic class YourAspect {\n    @Pointcut("execution(void method1())")\n    public void method1Execution() {}\n    \n    @Pointcut("method1Execution()")\n    private void stillMethod1Execution() {}\n\n    // ...\n}\n'})})]}),"\n",(0,i.jsx)(e.h3,{id:"aspectj\u5F62\u5F0Fpointcut\u8868\u8FBE\u5F0F\u7684\u6807\u8BC6\u7B26",children:"AspectJ\u5F62\u5F0FPointcut\u8868\u8FBE\u5F0F\u7684\u6807\u8BC6\u7B26"}),"\n",(0,i.jsx)(e.h4,{id:"execution",children:"execution"}),"\n",(0,i.jsx)(e.p,{children:"\u4F7F\u7528\u5B83\u5C06\u5E2E\u52A9\u6211\u4EEC\u5339\u914D\u62E5\u6709\u6307\u5B9A\u65B9\u6CD5\u7B7E\u540D\u7684Joinpoint\uFF0C\u4F7F\u7528\u683C\u5F0F\u5982\u4E0B"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.code,{children:"execution(modifiers-pattern ? ret-type-pattern declaring-type-pattern ? name-pattern(param-pattern) throws-pattern?)"})}),"\n",(0,i.jsx)(e.p,{children:"\u5176\u4E2D\u65B9\u6CD5\u7684\u8FD4\u56DE\u7C7B\u578B\u3001\u65B9\u6CD5\u540D\u3001\u4EE5\u53CA\u53C2\u6570\u90E8\u5206\u5339\u914D\u6A21\u5F0F\u65F6\u5FC5\u987B\u6307\u5B9A\u7684\uFF0C\u5176\u4ED6\u90E8\u5206\u7684\u5339\u914D\u6A21\u5F0F\u53EF\u4EE5\u7701\u7565\u3002"}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:"Foo Example"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class Foo {\n    public void doSomething(String arg) {\n        // ...\n}\n}\n"})})]}),"\n",(0,i.jsx)(e.p,{children:"\u90A3\u4E48\u53EF\u4EE5\u6307\u5B9A\u5982\u4E0BPointcut\u8868\u8FBE\u5F0F\u6765\u5339\u914DFoo\u7684doSomething\u65B9\u6CD5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"execution(public void Foo.doSomething(String))\n\nexecution(void Foo.doSomething(String))\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"*"}),"\u53EF\u4EE5\u7528\u4E8E\u4EFB\u4F55\u90E8\u5206\u7684\u5339\u914D\u6A21\u5F0F\u4E2D\uFF0C\u53EF\u4EE5\u5339\u914D\u76F8\u90BB\u7684\u591A\u4E2A\u5B57\u7B26*****"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"execution(* *(String))\n\nexecution(* *(*))\n"})}),"\n",(0,i.jsx)(e.p,{children:"**..**\u901A\u914D\u7B26\u53EF\u4EE5\u5728\u4E24\u4E2A\u4F4D\u7F6E\u4F7F\u7528"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"declaring-type-pattern\u5904\u4F7F\u7528\u6307\u5B9A\u591A\u4E2A\u5C42\u6B21\u7684\u7C7B\u578B\u58F0\u660E"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"// \u53EA\u80FD\u5B9A\u4F4D\u5230cn.spring21\u8FD9\u4E00\u5C42\u4E0B\u7684\u6240\u6709\u7C7B\u578B\nexecution(void cn.spring21.*.doSomething(*) \n\n// \u53EF\u4EE5\u5339\u914D\u5230\u6240\u6709\u7684cn.spring21\u5305\u4E0B\u7684\u5305\u62EC\u5B50\u5B59\u5305\nexecution(void cn.spring21..*.doSomething(*) \n"})}),"\n",(0,i.jsxs)(e.ol,{start:"2",children:["\n",(0,i.jsx)(e.li,{children:"\u7528\u4E8E\u65B9\u6CD5\u5217\u8868\u5339\u914D\u4F4D\u7F6E\uFF0C\u5219\u8868\u793A\u8BE5\u65B9\u6CD5\u53EF\u4EE5\u67090\u5230\u591A\u4E2A\u53C2\u6570\uFF0C\u53C2\u6570\u7C7B\u578B\u4E0D\u9650\u3002\u5982\u679C..\u6362\u6210*\uFF0C\u5219\u53EA\u80FD\u5339\u914D\u4E00\u4E2A\u53C2\u6570\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"execution(void *.doSomething(..))\n\n// \u8868\u793A\u7B2C\u4E00\u4E2A\u53C2\u6570\u4E3AString,\u7B2C\u4E8C\u4E2A\u53C2\u6570\u4E3A\u4EFB\u610F\u7C7B\u578B\nexecution(void doSomething(String,*)) \n\n// \u8868\u793A\u4E0D\u9650\u53C2\u6570\u683C\u5F0F\uFF0C\u4E0D\u9650\u7C7B\u578B\uFF0C\u4F46\u662F\u6700\u540E\u4E00\u4E2A\u53C2\u6570\u7C7B\u578B\u5FC5\u987B\u662FString\nexecution(void doSomething(..,String)) \n"})}),"\n",(0,i.jsx)(e.h4,{id:"within",children:"within"}),"\n",(0,i.jsx)(e.p,{children:"within\u6807\u8BC6\u7B26\u53EA\u63A5\u53D7\u7C7B\u7C7B\u578B\u7684\u58F0\u660E\uFF0C\u5B83\u5C06\u4F1A\u5339\u914D\u6307\u5B9A\u7C7B\u578B\u4E0B\u6240\u6709\u7684Joinpoint\u65B9\u6CD5\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.em,{children:"within\u5207\u70B9\u8868\u8FBE\u5F0F\u5199\u6CD5"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"within(cn.spring21.aop.target.MockTarget)\n// \u5339\u914Dtarget\u5305\u4E0B\u6240\u6709\u7C7B\u5185\u90E8\u7684\u65B9\u6CD5\u7EA7\u522B\u7684Joinpoint\nwithin(cn.spring21.aop.target.*) \n// \u5339\u914Daop\u5305\u4E0B\u4EE5\u53CA\u5B50\u5B59\u5305\u4E0B\u6240\u6709\u7C7B\u5185\u90E8\u65B9\u6CD5\u7EA7\u522B\u7684Joinpoint\nwithin(cn.spring21.aop..*) \n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.em,{children:"within\u5207\u70B9\u8868\u8FBE\u5F0F\u4F7F\u7528"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Retention(RetentionPolicy.RUNTIME)\n@Target({ElementType.METHOD,ElementType.TYPE})\npublic @interface AnyJoinpointAnnotation {}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@AnyJoinpointAnnotation\npublic class Foo{\n    public void method1(){}\n    public void method2(){}\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5F53\u4F7F\u7528",(0,i.jsx)(e.code,{children:"@within(AnyJoinpointAnnotation)"}),"\u7684Pointcut\u8868\u8FBE\u5F0F\u65F6\uFF0CFoo\u7C7B\u4E2Dmethod1\u3001method2\u7B49\u65B9\u6CD5\u5C06\u5168\u90E8\u88ABPointcu\u8868\u8FBE\u5F0F\u6240\u5339\u914D\u3002\u56E0\u4E3A\u8BE5\u7C7B\u6807\u6CE8\u4E86@AnyJoinpointAnnotation\uFF0C\u5176\u4ED6\u7C7B\u5982\u679C\u4E5F\u6807\u6CE8\u4E86\u8BE5\u6CE8\u89E3\uFF0C\u4E5F\u4F1A\u88AB\u5339\u914D\u5230\u3002"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.em,{children:"\u6CE8\u610F@within\u53EA\u63A5\u53D7\u6CE8\u89E3\u7C7B\u578B\uFF0C\u5E76\u5BF9\u88AB\u6307\u5B9A\u6CE8\u89E3\u7C7B\u578B\u6240\u6807\u6CE8\u7684\u7C7B\u751F\u6548"})}),"\n",(0,i.jsx)(e.h4,{id:"this\u548Ctarget",children:"this\u548Ctarget"}),"\n",(0,i.jsx)(e.p,{children:"\u5728AspectJ\u4E2D\uFF0Cthis\u6307\u4EE3\u8C03\u7528\u65B9\u6CD5\u4E00\u65B9\u6240\u5728\u7684\u5BF9\u8C61\uFF0Ctarget\u6307\u4EE3\u88AB\u8C03\u7528\u65B9\u6CD5\u6240\u5728\u7684\u5BF9\u8C61\uFF0C\u8FD9\u6837\u901A\u5E38\u53EF\u4EE5\u540C\u65F6\u4F7F\u7528\u8FD9\u4E24\u4E2A\u6807\u8BC6\u7B26\u9650\u5B9A\u65B9\u6CD5\u7684\u8C03\u7528\u5173\u7CFB\u3002\u6BD4\u5982\uFF0C\u5982\u679CObject1\u3001Object2\u90FD\u4F1A\u8C03\u7528Object3\n\u5BF9\u8C61\u7684\u67D0\u4E2A\u65B9\u6CD5\uFF0C\u90A3\u4E48\uFF0CPointcut\u8868\u8FBE\u5F0F\u5B9A\u4E49this(Object2) && target(Object3) \u53EA\u4F1A\u5F53Object2\u8C03\u7528Object3\u4E0A\u7684\u65B9\u6CD5\u7684\u65F6\u5019\u624D\u4F1A\u5339\u914D\uFF0C\u800CObject1\u8C03\u7528Object3\u4E0A\u7684\u65B9\u6CD5\u7684\u65F6\u5019\u4E0D\u4F1A\u88AB\u5339\u914D\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u5728Spring AOP\u4E2D\u7684this\u548Ctarget\u8868\u793A\u8BED\u4E49\u4E0D\u540C\u4E8EAspectJ\u4E2D\uFF0Cthis\u6307\u4EE3\u7684\u662F\u76EE\u6807\u5BF9\u8C61\u7684\u4EE3\u7406\u5BF9\u8C61\uFF0C\u800Ctarget\u662F\u76EE\u6807\u5BF9\u8C61\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u4E0D\u8BBA\u4F7F\u7528\u57FA\u4E8E\u63A5\u53E3\u7684\u4EE3\u7406\u65B9\u5F0F\u8FD8\u662F\u57FA\u4E8E\u7C7B\u7684\u4EE3\u7406\u65B9\u5F0F\uFF0Cthis(ProxyInterface) \u548C target(ProxyInterface)\u8D77\u5230\u7684\u6548\u679C\u5DEE\u4E0D\u591A\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u5982\u679C\u6307\u5B9A\u5177\u4F53\u7C7B\u578Bthis(TargetFoo)\u548Ctarget(TargetFoo)\uFF0Ctarget(TargetFoo)\u5339\u914D\u5230\u76EE\u6807\u5BF9\u8C61\u4E2D\u6240\u6709\u7684Joinpoint\uFF0C\u56E0\u4E3A\u76EE\u6807\u5BF9\u8C61\u786E\u5B9E\u662FTargetFoo\u7C7B\u578B\uFF0C\u800Cthis(TargetFoo)\u5219\u4E0D\u53EF\u4EE5\u3002"}),"\n",(0,i.jsx)(e.p,{children:"this\u548Ctarget\u6807\u8BC6\u7B26\u90FD\u662F\u5728Pointcut\u8868\u8FBE\u5F0F\u4E2D\u4E0E\u5176\u4ED6\u6807\u8BC6\u7B26\u7ED3\u5408\u4F7F\u7528\uFF0C\u4EE5\u8FDB\u4E00\u6B65\u52A0\u5F3A\u5339\u914D\u7684\u9650\u5B9A\u89C4\u5219"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"execution(void cn.spring21.*.doSomething(*)) && this(TargetFoo)\n\nexecution(void cn.spring21.*.doSomething(*)) && targe(ProxyInterface)\n\n// \u5339\u914D \u540C\u65F6\u5B9E\u73B0ProxyInterface \u548C ProxyInterface2\nthis(ProxyInterface) && target(proxyInterface2)\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5728Spring AOP\u4E2D @within \u548C @target\u6CA1\u6709\u592A\u5927\u7684\u533A\u522B\u3002\u53EA\u4E0D\u8FC7@within\u5C5E\u4E8E\u9759\u6001\u5339\u914D\uFF0C\u800C@target\u5219\u662F\u5728\u8FD0\u884C\u65F6\u52A8\u6001\u5339\u914DJoinpoint\u3002"}),"\n",(0,i.jsx)(e.h4,{id:"args",children:"args"}),"\n",(0,i.jsx)(e.p,{children:"\u8BE5\u6807\u8BC6\u7B26\u7684\u4F5C\u7528\u662F\uFF0C\u5E2E\u52A9\u6211\u4EEC\u6355\u6349\u62E5\u6709\u6307\u5B9A\u53C2\u6570\u7C7B\u578B\u3001\u6307\u5B9A\u53C2\u6570\u6570\u636E\u91CF\u7684\u65B9\u6CD5\u7EA7Joinpoint\uFF0C\u800C\u4E0D\u7BA1\u8BE5\u65B9\u6CD5\u5728\u4EC0\u4E48\u7C7B\u578B\u4E2D\u88AB\u58F0\u660E\u3002\u4F8B\u5982\uFF0Cargs(cn.spring21.unveilspring.domain.User)\u90A3\u4E48\u4E0B\u9762\u65B9\u6CD5\u7B7E\u540D\u90FD\u4F1A\u88AB\u5339\u914D\u5230"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class Foo {\n    public boolean login(User user) {\n        // ...\n    }\n}\n\npublic class Bar {\n    public boolean isLogin(User user) {\n        // ...\n    }\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u8981\u60F3\u6355\u6349",(0,i.jsx)(e.code,{children:"public boolean login(Object user)"})," \u4F7F\u7528\u7C7B\u4F3C\u4E8E",(0,i.jsx)(e.code,{children:"execution(* *(User))"}),"\u8FD9\u6837\u7684\u8868\u8FBE\u5F0F\u65E0\u6CD5\u6355\u6349\u5230(\u56E0\u4E3A\u5B83\u662F\u9759\u6001\u7684Pointcut)\uFF0C\u9700\u8981\u4F7F\u7528args\u7684\u6807\u8BC6\u7B26\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u4F7F\u7528@args\u6807\u8BC6\u7B26\u7684Pointcut\u8868\u8FBE\u5F0F\u4F1A\u68C0\u67E5\u5F53\u524D\u65B9\u6CD5\u7EA7\u7684Joinpoint\u7684\u65B9\u6CD5\u53C2\u6570\u7C7B\u578B\uFF0C\u5982\u679C\u8BE5\u6B21\u4F20\u5165\u7684\u53C2\u6570\u7C7B\u578B\u62E5\u6709@args\u6240\u5236\u5B9A\u7684\u6CE8\u89E3\uFF0C\u5F53\u524DJoinpoint\u5C06\u88AB\u5339\u914D\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://s2.loli.net/2023/07/15/hvlZ4iRWjtozqS3.png",alt:""})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.em,{children:"@args\u4F1A\u5C1D\u8BD5\u5BF9\u7CFB\u7EDF\u4E2D\u6240\u6709\u5BF9\u8C61\u7684\u6BCF\u6B21\u65B9\u6CD5\u6267\u884C\u7684\u53C2\u6570\uFF0C\u90FD\u8FDB\u884C\u6307\u5B9A\u7684\u6CE8\u89E3\u52A8\u6001\u68C0\u67E5\u3002\u53EA\u8981\u53C2\u6570\u7684\u7C7B\u578B\u6807\u6CE8\u6709@args\u6307\u5B9A\u7684\u6CE8\u89E3\u7C7B\u578B\uFF0C\u5F53\u524D\u65B9\u6CD5\u6267\u884C\u5C31\u5C06\u5339\u914D\u3002"})}),"\n",(0,i.jsx)(e.h4,{id:"annotation",children:"annotation"}),"\n",(0,i.jsx)(e.p,{children:"\u4F7F\u7528annotation\u6807\u8BC6\u7B26\u7684Pointcut\u8868\u8FBE\u5F0F\uFF0C\u5C06\u4F1A\u5C1D\u8BD5\u68C0\u67E5\u7CFB\u7EDF\u4E2D\u6240\u6709\u5BF9\u8C61\u7684\u6240\u6709\u65B9\u6CD5\u7EA7\u522BJoinpoint\u3002\u5982\u679C\u88AB\u68C0\u6D4B\u7684\u65B9\u6CD5\u6807\u6CE8\u6709@annotation\u6807\u8BC6\u7B26\u6240\u6307\u5B9A\u7684\u6CE8\u89E3\u7C7B\u578B\uFF0C\u90A3\u4E48\u5F53\u524D\u65B9\u6CD5\u6240\u5728\u7684Joinpoint\u5C06\u88ABPointcut\u8868\u8FBE\u5F0F\u6240\u5339\u914D\u3002"}),"\n",(0,i.jsxs)(e.p,{children:["\u60F3\u8981\u4E0B\u9762\u65B9\u6CD5\u652F\u6301\u4E8B\u52A1\u673A\u5236\uFF0C\u53EA\u9700\u8981\u5728\u76F8\u5E94\u7684\u65B9\u6CD5\u4E0A\u4E00\u4E2A\u6CE8\u89E3@Transactional\uFF0C\u7136\u540E\u4F7F\u7528Pointcut\u8868\u8FBE\u5F0F\u6307\u5B9A",(0,i.jsx)(e.code,{children:"@annotation(org.springframework.transaction.annotation.Transactional)"}),"\u6CE8\u610F@Transactional\u6CE8\u89E3\u88AB\u5B9A\u4E49\u4E3A",(0,i.jsx)(e.code,{children:"@Target(ElementType.METHOD)"}),"\u3002"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5373\u4F7F\u5728Spring AOP \u4E2D\u53EF\u4EE5\u4F7F\u7528AspectJ\u4E2D\u7684Pointcut\u8868\u8FBE\u5F0F\u6807\u8BC6\u7B26\uFF0C\u5B83\u4EEC\u7684\u8BED\u4E49\u8DDFAspectJ\u4E2D\u7684\u6700\u7EC8\u8BED\u4E49\u4F1A\u6709\u5DEE\u522B\u3002\u6240\u4EE5\uFF0C\u4E0E\u5176\u8BF4Spring AOP\u73B0\u5728\u53EF\u4EE5\u4F7F\u7528AspectJ\u7684Pointcut\u8868\u8FBE\u8BED\u8A00\uFF0C\u4E0D\u5982\u8BF4Spring AOP \u501F\u7528\u4E86AspectJ\u7684Pointcut\u8868\u8FBE\u8BED\u8A00\u7684\u201C\u5916\u8863\u201D\uFF0C\u800C\u5B9E\u9645\u4E0A\u5E95\u5C42\u7684\u8BED\u4E49\u548C\u6700\u7EC8\u5339\u914D\uFF0C\u5374\u8FD8\u662F\u6CBF\u7528Spring AOP\u6700\u521D\u7684\u673A\u5236\u3002\u53E6\u5916Spring AOP\u8FD8\u53EF\u80FD\u5728\u539F\u6765\u8868\u8FBE\u5F0F\u7684\u57FA\u7840\u4E0A\u589E\u52A0\u65B0\u7684\u6807\u5FD7\u7B26\uFF0C\u5982bean(..)\u3002AspectJ\u6269\u5C55\u4E86Java\u8BED\u8A00\uFF0C\u73B0\u5728Spring AOP\u7684Pointcut\u8868\u8FBE\u5F0F\u5219\u8981\u6269\u5C55AspectJ\u7684Pointcut\u3002"})}),"\n",(0,i.jsx)(e.p,{children:"@AspectJ\u5F62\u5F0F\u7684Pointcut\u5728Spring AOP\u4E2D\u7684\u771F\u5B9E\u9762\u76EE"}),"\n",(0,i.jsx)(e.p,{children:"\u5B9E\u9645\u4E0A\uFF0C@AspectJ\u5F62\u5F0F\u58F0\u660E\u7684\u6240\u6709Pointcut\u8868\u8FBE\u5F0F\uFF0C\u5728Spring AOP\u5185\u90E8\u90FD\u4F1A\u901A\u8FC7\u89E3\u6790\uFF0C\u8F6C\u5316\u4E3A\u5177\u4F53\u7684Pointcut\u5BF9\u8C61\u3002\u56E0\u4E3ASpring AOP\u6709\u81EA\u5DF1\u7684Pointcut\u5B9A\u4E49\u7ED3\u6784\uFF0C\u6240\u4EE5@AspectJ\u5F62\u5F0F\u58F0\u660E\u8FD9\u4E9BPointcut\u8868\u8FBE\u5F0F\uFF0C\u6700\u7EC8\u4F1A\u8F6C\u5316\u4E3A\u4E00\u4E2A\u4E13\u95E8\u9762\u5411AspectJ\u7684Pointcut\u5B9E\u73B0\u3002"}),"\n",(0,i.jsx)(e.p,{children:"org.springframework.aop.aspectj.AspectJExpressionPointcut\u4EE3\u8868Spring AOP\u4E2D\u9762\u5411AspectJ\u7684Pointcut\u5177\u4F53\u5B9E\u73B0\u3002\u867D\u7136\u5B83\u4F7F\u7528AspectJ\n\u7684\u76F8\u5E94\u652F\u6301\uFF0C\u4F46\u662F\u4F9D\u7136\u9075\u5FAASpring AOP\u7684Pointcut\u5B9A\u4E49\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://s2.loli.net/2023/07/15/QXc4awHlyRibeIj.png",alt:""})}),"\n",(0,i.jsx)(e.p,{children:"\u5B9A\u4E49ExpressionPointcut\u548CAbstractExpressionPointcut\u4E3B\u8981\u4E3A\u4E86\u4EE5\u540E\u7684\u6269\u5C55\u6027\u3002\u5982\u679C\u8FD8\u6709AspectJ\u7684Pointcut\u63CF\u8FF0\u8BED\u8A00\u4E4B\u5916\u7684\u5F62\u5F0F\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5728\u8FD9\u4E24\u4E2A\u57FA\u7840\u4E0A\u8FDB\u884C\u96C6\u6210\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u5728AspectJProxyFactory\u6216\u8005AnnotationAwareAspectJAutoProxyCreator\u901A\u8FC7\u53CD\u5C04\u83B7\u53D6\u4E86AspectJ\u4E2D\u7684@Pointcut\u5B9A\u4E49\u7684AspectJ\u5F62\u5F0F\u7684\u5B9A\u4E49\u4E4B\u540E\uFF0C\u5728Spring AOP\u6846\u67B6\u5185\u90E8\u90FD\u4F1A\u6784\u9020\u4E00\u4E2A\u5BF9\u5E94\u7684AspectJExpressionPointcut\u5BF9\u8C61\u5B9E\u4F8B\u3002AspectJExpressionPointcut\u5185\u90E8\u6301\u6709\u7684\u901A\u8FC7\u53CD\u5C04\u83B7\u5F97\u7684Pointcut\u8868\u8FBE\u5F0F\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://s2.loli.net/2023/07/15/SlIhfBd7UZtmqEC.png",alt:""})}),"\n",(0,i.jsx)(e.p,{children:"AspectJExpressionPointcut \u5C5E\u4E8ESpring AOP\u7684Pointcut\u5B9A\u4E49\u4E4B\u4E00\uFF0CSpring AOP\u6846\u67B6\u5185\u90E8\u5904\u7406Pointcut\u5339\u914D\u7684\u903B\u8F91\u4E0D\u9700\u8981\u6539\u53D8\uFF0C\u4F9D\u7136\u4F7F\u7528\u539F\u6765\u7684\u5339\u914D\u673A\u5236\uFF0C\u5373\u901A\u8FC7ClassFilter\u548CMethodMatcher\u8FDB\u884C\u5177\u4F53Joinpoint\u7684\u5339\u914D\u5DE5\u4F5C\u3002\u4E0D\u8FC7\uFF0CAspectJExpressionPointcut\u5728\u5B9E\u73B0ClassFilter\u548CMethodMatcher\u76F8\u5E94\u7684\u65B9\u6CD5\u903B\u8F91\u7684\u65F6\u5019\uFF0C\u4F1A\u59D4\u6258AspectJ\u7C7B\u5E93\u7684\u76F8\u5173\u7C7B\u505A\u5177\u4F53\u7684\u5DE5\u4F5C\u3002AspectJExpressionJoinpoint\u4F1A\u59D4\u6258AspectJ\u7C7B\u5E93\u4E2D\u7684PointcutParser\u6765\u5BF9\u5B83\u6240\u6301\u6709\u7684AspectJ\u5F62\u5F0F\u7684Pointcut\u8868\u8FBE\u5F0F\u8FDB\u884C\u89E3\u6790\u3002PointcutParser\u89E3\u6790\u5B8C\u6210\u4E4B\u540E\u4F1A\u8FD4\u56DE\u4E00\u4E2APointcutExpression\u5BF9\u8C61(\u4F9D\u7136\u662FAspectJ\u7C7B\u5E93\u4E2D\u7684\u7C7B)\uFF0C\u4E4B\u540E\u5339\u914D\u4E0E\u5426\u5C31\u76F4\u63A5\u59D4\u6258\u8FD9\u4E2APointcutExpression\u5BF9\u8C61\u7684\u76F8\u5173\u65B9\u6CD5\u8FDB\u884C\u5904\u7406\u4E86\u3002"}),"\n",(0,i.jsx)(e.p,{children:"AspectJExpressionPointcut\u5C5E\u4E8E\u9762\u5411AspectJ\u7684Pointcut\u5B9E\u73B0\uFF0C\u6211\u4EEC\u53EF\u4EE5\u50CFSpring AOP\u4E2D\u5176\u4ED6\u5404\u79CDPointcut\u5B9E\u73B0\u7C7B\u90A3\u6837\u6765\u4F7F\u7528\u5B83\u3002\u53EA\u4E0D\u8FC7\uFF0C\u6784\u9020\u5B8C\u6210\u540E\uFF0C\u4E0D\u4E3A\u5B83\u8BBE\u7F6E\u65B9\u6CD5\u540D\u6216\u8005\u6B63\u5219\u8868\u8FBE\u5F0F\uFF0C\u800C\u662F\u5982\u4E0B\u6240\u793A\u8BBE\u7F6E@AspectJ\u5F62\u5F0F\u7684Pointcut"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'AspectJExpressionPointcut pointcut = new AspectJExpressionPointcut();\npointcut.setExpression("execution( * someMethodName(..))");\n'})}),"\n",(0,i.jsx)(e.h2,{id:"aspectj\u5F62\u5F0F\u7684advice",children:"@AspectJ\u5F62\u5F0F\u7684Advice"}),"\n",(0,i.jsx)(e.p,{children:"@AspectJ\u5F62\u5F0F\u7684\u5B9A\u4E49\uFF0C\u5B9E\u9645\u4E0A\u5C31\u662F\u4F7F\u7528@AspectJ\u6807\u6CE8\u7684AspectJ\u5B9A\u4E49\u7C7B\u4E2D\u7684\u666E\u901A\u65B9\u6CD5\uFF0C\u53EA\u4E0D\u8FC7\u8FD9\u4E9B\u65B9\u6CD5\u9700\u8981\u9488\u5BF9\u4E0D\u540C\u7684Advice\u7C7B\u578B\u5BF9\u5E94\u7684\u6CE8\u89E3\u8FDB\u884C\u6807\u6CE8\u3002"}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:"\u4F7F\u7528 Pointcut \u8BBE\u7F6E BeforeAdvice"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'/**\n * \u4F7F\u7528AspectJ\u5F62\u5F0F\n */\n@Aspect\npublic class ResourceSetupAspectJ {\n    private Resource resource;\n    \n    @Before("execution(boolean *.execute())")\n    public void setupResourcesBefore() throws Throwable {\n        if(!getResource().exists())\n            FileUtils.forceMkdir(getResource().getFile());\n    }\n    // \u7701\u7565getter setter\n}\n'})})]}),"\n",(0,i.jsx)(e.p,{children:"\u4F7F\u7528Pointcut Signature\u5F15\u7528Pointcut"}),"\n",(0,i.jsx)(e.p,{children:"Advice\u4E2D\u53C2\u6570\u4F20\u9012"}),"\n",(0,i.jsx)(e.p,{children:"\u67D0\u4E9B\u60C5\u51B5\u4E0B\uFF0C\u6211\u4EEC\u53EF\u80FD\u9700\u8981\u5728Advice\u5B9A\u4E49\u4E2D\u8BBF\u95EEJoinpoint\u5904\u7684\u65B9\u6CD5\u53C2\u6570\uFF0C\u57281.x\u7684Spring AOP\u4E2D\uFF0C\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7MethodBeforeAdvice\u65B9\u6CD5\u4F20\u5165\u7684Object\u6570\u7EC4\uFF0C\u8BBF\u95EE\u76F8\u5E94\u7684\u65B9\u6CD5\u53C2\u6570\u3002\u73B0\u5728\u6709\u4E24\u79CD\u65B9\u6CD5\u53EF\u4EE5\u8FBE\u5230\u76F8\u540C\u7684\u76EE\u7684\u3002"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u901A\u8FC7org.aspectj.lang.JoinPoint\u3002\u5728@AspectJ\u5F62\u5F0F\u7684Aspect\u4E2D\uFF0C\u5B9A\u4E49Before Advice\u7684\u65B9\u6CD5\u53EF\u4EE5\u5C06\u7B2C\u4E00\u4E2A\u53C2\u6570\u58F0\u660E\u4E3Aorg.aspectj.lang.JoinPoint\u7C7B\u578B\uFF0C\u901A\u8FC7Joinpoint\u6211\u4EEC\u53EF\u4EE5\u501F\u52A9\u5B83\u7684getArgs()\u65B9\u6CD5\uFF0C\u8BBF\u95EE\u76F8\u5E94\u7684Joinpoint\u65B9\u6CD5\u7684\u53C2\u6570\u503C\uFF0C\u53E6\u5916\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528getThis()\u83B7\u53D6\u5F53\u524D\u4EE3\u7406\u5BF9\u8C61\uFF0CgetTarget()\u53D6\u5F97\u76EE\u6807\u5BF9\u8C61\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u901A\u8FC7args\u6807\u5FD7\u7B26\u7ED1\u5B9A\u3002\u524D\u9762\u5DF2\u7ECF\u4ECB\u7ECD\u8FC7\u4E86args\u6807\u5FD7\u7B26\uFF0C\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7\u4E3A\u5176\u5236\u5B9A\u76F8\u5E94\u7684\u5BF9\u8C61\u7C7B\u578B\uFF0C\u6765\u8FDB\u4E00\u6B65\u9650\u5B9APointcut\u5B9A\u4E49\u3002\u5F53args\u6807\u8BC6\u7B26\u63A5\u53D7\u7684\u4E0D\u662F\u5177\u4F53\u7684\u5BF9\u8C61\u7C7B\u578B\uFF0C\u800C\u662F\u67D0\u4E2A\u53C2\u6570\u540D\u79F0\u7684\u65F6\u5019\u5B83\u4F1A\u5C06\u8FD9\u4E2A\u53C2\u6570\u540D\u79F0\u5BF9\u5E94\u7684\u53C2\u6570\u503C\u7ED1\u5B9A\u5230\u5BF9Advice\u65B9\u6CD5\u7684\u8C03\u7528\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6CE8\u610Fargs\u6307\u5B9A\u7684\u53C2\u6570\u540D\u79F0\u5FC5\u987B\u4E0EAdvice\u5B9A\u4E49\u6240\u5728\u65B9\u6CD5\u7684\u53C2\u6570\u540D\u79F0\u76F8\u540C\u3002\u5728\u8FD9\u91CCargs\u6307\u5B9A\u7684\u503C\u548CsetupResourceBefore\u65B9\u6CD5\u7684\u53C2\u6570\u540D\u90FD\u662FtaskName\u3002\u5982\u679CAdvice\u5F15\u7528\u7684\u662F\u72EC\u7ACB\u7684Pointcut\u5B9A\u4E49\uFF0C\u4F7F\u7528args\u7ED1\u5B9A\u7684\u5F62\u5F0F\u4E5F\u662F\u5927\u540C\u5C0F\u5F02\u7684\u3002"}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:"Advice\u5F15\u7528\u7684\u662F\u72EC\u7ACB\u7684Pointcut\u5B9A\u4E49"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Pointcut("execution(boolean *.execute(String,..)) && args(taskName)")\nprivate void resourceSetupJoinpoints(String taskName) {}\n\n@Before(value="resourceSetupJoinpoints(taskName)")\npublic void setupResourcesBefore(String taskName) throws Throwable{}\n'})})]}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:"\u540C\u65F6\u4F7F\u7528JoinPoint\u4EE5\u53CA\u4F7F\u7528args\u53C2\u6570\u540D\u79F0\u7ED1\u5B9A\u529F\u80FD"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Before(value="execution(boolean *.execute(String,..)) && args(taskName)")\npublic void setupResourcesBefore1(JoinPoint joinpoint, String taskName) throws Throwable {\n    // ...\n}\n'})})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u9488\u5BF9Before Advice\u8BBF\u95EE\u65B9\u6CD5\u53C2\u6570\u7684\u4E24\u79CD\u65B9\u5F0F"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5728AspectJ\u5F62\u5F0F\u7684Advice\u58F0\u660E\u65B9\u5F0F\u4E2D\uFF0C\u4E0D\u53EABefore Advice\u65B9\u6CD5\u7B2C\u4E00\u4E2A\u53C2\u6570\u53EF\u4EE5\u58F0\u660E\u4E3Aorg.aspectj.lang.JoinPoint\u7C7B\u578B\uFF0C\u5B9E\u9645\u4E0A\uFF0C\u9664\u4E86Around Advice\u548CIntroduction\u4E0D\u53EF\u4EE5\u7528\u4E4B\u5916\uFF0C\u5269\u4F59\u7684Advice\u7C7B\u578B\u7684\u65B9\u6CD5\u58F0\u660E\u90FD\u9075\u5FAA\u8FD9\u4E2A\u89C4\u5219"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u4E0D\u53EA\u53EF\u4EE5\u4F7F\u7528args\u6807\u8BC6\u7B26\u6765\u7ED1\u5B9A\u53C2\u6570\u58F0\u660E\u5230\u65B9\u6CD5\uFF0C\u5B9E\u9645\u4E0APointcut\u6807\u8BC6\u7B26\u4E2D\uFF0C\u9664\u4E86execution\u6807\u8BC6\u7B26\u4E0D\u4F1A\u76F4\u63A5\u6307\u5B9A\u5BF9\u8C61\u7C7B\u578B\u4E4B\u5916\uFF0C\u5176\u4ED6\u50CFthis\u3001target\u3001@within\u3001@target\u3001@annotation\u3001@args\u7B49\u539F\u672C\u90FD\u662F\u6307\u5B9A\u5BF9\u8C61\u7C7B\u578B\u7684\u3002\u4ED6\u4EEC\u4E0Eargs\u4E00\u6837\uFF0C\u5728\u8FD9\u6837\u7684\u573A\u5408\u4E0B\uFF0C\u5982\u679C\u5B83\u4EEC\u7684\u6307\u5B9A\u7684\u662F\u53C2\u6570\u540D\u79F0"})}),"\n",(0,i.jsx)(e.h4,{id:"spring-20-\u57FA\u4E8Exsd\u5404\u79CDadvice\u7684\u914D\u58F0\u660E\u65B9\u5F0F",children:"Spring 2.0 \u57FA\u4E8EXSD\u5404\u79CDAdvice\u7684\u914D\u58F0\u660E\u65B9\u5F0F"}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:"AspectAdvice"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'package org.springframework.mylearntest.aop2.schemaapsect;\n\nimport org.apache.commons.io.FileUtils;\nimport org.apache.commons.lang3.exception.ExceptionUtils;\nimport org.aspectj.lang.JoinPoint;\nimport org.aspectj.lang.ProceedingJoinPoint;\nimport org.aspectj.lang.annotation.*;\nimport org.springframework.core.io.Resource;\nimport org.springframework.util.StopWatch;\n\n/**\n * @Author: WhaleFall541\n * @Date: 2020/8/13 20:56\n */\n@Aspect\npublic class AspectAdvice {\n    private Resource resource;\n\n    public Resource getResource() {\n        return resource;\n    }\n\n    public void setResource(Resource resource) {\n        this.resource = resource;\n    }\n\n    @AfterThrowing(pointcut = "execution(boolean *.execute(String, ..))", throwing = "e")\n    public void afterThrowing(RuntimeException e) {\n        final String exceptionMsg = ExceptionUtils.getStackTrace(e);\n        // ...\n    }\n\n    @AfterReturning(value = "execution(boolean *.execute(String, ..))",returning = "retValue")\n    public void taskExceptionCompleted(JoinPoint jp,boolean retValue) {\n        //Class clazz = jp.getTarget().getClass();\n        //getSqlMapClientTemplate().insert("BATCH.insertTaskStatus", clazz.getName());\n    }\n\n    @After("execution(boolean *.execute(String, ..))")\n    public void cleanUpResourcesIfNecessary() throws Throwable {\n        if (getResource().exists())\n            FileUtils.forceMkdir(getResource().getFile());\n    }\n\n    @Around("execution(boolean *.execute(String, ..))")\n    public Object performanceTrace(ProceedingJoinPoint pjp) throws Throwable {\n        StopWatch watch = new StopWatch();\n        try {\n            watch.start();\n            return pjp.proceed();\n        } finally {\n            watch.stop();\n            System.out.println("watch.toString() = " + watch.toString());\n        }\n    }\n}\n'})})]}),"\n",(0,i.jsx)(e.h4,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsx)(e.p,{children:"\u5728Spring\u4E2D\uFF0CIntroduction\u7684\u5B9E\u73B0\u662F\u901A\u8FC7\u5C06\u9700\u8981\u6DFB\u52A0\u7684\u65B0\u7684\u884C\u4E3A\u903B\u8F91\uFF0C\u4EE5\u65B0\u7684\u63A5\u53E3\u5B9A\u4E49\u7684\u589E\u52A0\u5230\u76EE\u6807\u5BF9\u8C61\u4E0A\u3002\u8981\u4EE5@AspectJ\u5F62\u5F0F\u58F0\u660EIntroduction\uFF0C\u6211\u4EEC\u9700\u8981\u5728Aspect\u4E2D\u58F0\u660E\u4E00\u4E2A\u793A\u4F8B\u53D8\u91CF\uFF0C\u5B83\u7684\u7C7B\u578B\u5BF9\u5E94\u7684\u5C31\u662F\u65B0\u589E\u52A0\u7684\u63A5\u53E3\u7C7B\u578B\uFF0C\u7136\u540E\u4F7F\u7528org.aspectj.lang.annotatioin.DeclareParents\u5BF9\u5176\u8FDB\u884C\u6807\u6CE8\u3002\u901A\u8FC7@DeclareParents\u6307\u5B9A\u65B0\u63A5\u53E3\u5B9A\u4E49\u7684\u5B9E\u73B0\u7C7B\u4EE5\u53CA\u5C06\u8981\u52A0\u8BF8\u5176\u4E0A\u7684\u76EE\u6807\u5BF9\u8C61\u3002"}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:"IntroductionAspect"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'package org.springframework.mylearntest.aop2.introduction;\n\nimport org.aspectj.lang.annotation.Aspect;\nimport org.aspectj.lang.annotation.DeclareParents;\nimport org.springframework.mylearntest.aop1.weaver.proxyfactorybean.CounterImpl;\nimport org.springframework.mylearntest.aop1.weaver.proxyfactorybean.ICounter;\n\n/**\n * @Author: WhaleFall541\n * @Date: 2020/8/9 16:50\n * \u5C06ICounter\u884C\u4E3Aintroduce\u9644\u52A0\u5230ITask\u4E4B\u4E0A\n */\n@Aspect\npublic class IntroductionAspect {\n	// value\u5C5E\u6027\u6307\u5B9A\u5C06\u8981\u5E94\u7528\u5230\u7684\u4E00\u4E2A\u5BF9\u8C61\uFF0C\u4E5F\u53EF\u4EE5\u67D0\u4E2A\u5305\u4E0B\u6240\u6709\u7C7Bvalue="cn.spring21.unveilspring.service.*"\n	// \u901A\u8FC7defaultImpl\u6307\u5B9A\u65B0\u589E\u52A0\u7684\u63A5\u53E3\u5B9A\u4E49\u7684\u5B9E\u73B0\u7C7B\uFF0C\u5728\u8FD9\u91CCICounter\u7684\u5B9E\u73B0\u7C7B\u4E3Aorg.springframework.mylearntest.aop1.weaver.proxyfactorybean.CounterImpl\n	@DeclareParents(value = "org.springframework.mylearntest.aop1.weaver.baseoninterface.MockTask", defaultImpl =\n			CounterImpl.class)\n	public ICounter counter;// ICounter\u5373\u4E3A\u5C06\u8981\u4E3A\u76EE\u6807\u5BF9\u8C61\u97A5\u5BB6\u7684\u5BF9\u8C61\u7C7B\u578B\n}\n'})})]}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:"xml\u914D\u7F6E"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n	   xmlns:context="http://www.springframework.org/schema/context"\n	   xsi:schemaLocation=\n			   "http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd\n				http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.2.xsd\n              	  http://www.springframework.org/schema/aop https://www.springframework.org/schema/aop/spring-aop.xsd"\n	   xmlns:aop="http://www.springframework.org/schema/aop">\n\n	<aop:aspectj-autoproxy proxy-target-class="true"/>\n\n	<bean id="task" class="org.springframework.mylearntest.aop1.weaver.baseoninterface.MockTask" scope="prototype"/>\n\n	<bean id="counterIntroduction" class="org.springframework.mylearntest.aop2.introduction.IntroductionAspect"/>\n</beans>\n'})})]}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:"Test4IntroductionAspect"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'package org.springframework.mylearntest.aop2.introduction;\n\nimport org.springframework.context.ApplicationContext;\nimport org.springframework.context.support.ClassPathXmlApplicationContext;\nimport org.springframework.mylearntest.aop1.weaver.proxyfactorybean.ICounter;\n\n/**\n * @Author: WhaleFall541\n * @Date: 2020/8/9 17:10\n */\npublic class Test4IntroductionAspect {\n	public static void main(String[] args) {\n		ApplicationContext context = new ClassPathXmlApplicationContext("introductionaspect/introductionaspect.xml");\n		Object task1 = context.getBean("task");\n		Object task2 = context.getBean("task");\n\n		System.out.println(((ICounter)task1).getCounter()); // 1\n		System.out.println(((ICounter)task1).getCounter()); // 2\n		System.out.println(((ICounter)task2).getCounter()); // 1\n	}\n}\n'})})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.em,{children:(0,i.jsx)(e.strong,{children:"\u6CE8\u610F Introduction\u5C5E\u4E8Eper-instance\u7C7B\u578B\u7684Advice\uFF0C\u6240\u4EE5\u4E0D\u8981\u5FD8\u8BB0\u76EE\u6807\u5BF9\u8C61\u7684scope\u901A\u5E38\u60C5\u51B5\u4E0B\u5E94\u8BE5\u8BBE\u7F6E\u4E3Aprototype"})})}),"\n",(0,i.jsx)(e.h4,{id:"advice\u7684\u6267\u884C\u987A\u5E8F",children:"Advice\u7684\u6267\u884C\u987A\u5E8F"}),"\n",(0,i.jsx)(e.p,{children:"\u5982\u679C\u5339\u914D\u540C\u4E00\u4E2AJoinpoint\u7684\u591A\u4E2AAdvice\u90FD\u58F0\u660E\u5728\u540C\u4E00\u4E2AAspect\u5B9A\u4E49\u4E2D\uFF0C\u90A3\u4E48\u8FD9\u4E9BAdvice\u6267\u884C\u987A\u5E8F\uFF0C\u7531\u4ED6\u4EEC\u5728Aspect\u4E2D\u7684\u58F0\u660E\u987A\u5E8F\u51B3\u5B9A\u3002\u6700\u5148\u58F0\u660E\u7684Advice\u62E5\u6709\u6700\u9AD8\u7684\u4F18\u5148\u7EA7\u3002\u5BF9\u4E8EBefore Advice\u6765\u8BF4\uFF0C\u62E5\u6709\u6700\u9AD8\u4F18\u5148\u7EA7\u7684\u6700\u5148\u8FD0\u884C\uFF0C\u800C\u5BF9\u4E8EAfterReturningAdvice\uFF0C\u62E5\u6709\u6700\u9AD8\u4F18\u5148\u7EA7\u7684\u5219\u662F\u6700\u540E\u8FD0\u884C\u3002"}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:"MultiAdviceAspect"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'package org.springframework.mylearntest.aop2.priorityofadvice;\n\nimport org.aspectj.lang.annotation.AfterReturning;\nimport org.aspectj.lang.annotation.Aspect;\nimport org.aspectj.lang.annotation.Before;\nimport org.aspectj.lang.annotation.Pointcut;\n\n/**\n * @Author: WhaleFall541\n * @Date: 2020/8/9 18:00\n * \u5982\u679C\u5C06\u8BE5AspectJ\u7EC7\u5165\u76EE\u6807\u5BF9\u8C61\uFF0C\u90A3\u4E48\u53EF\u4EE5\u5F97\u5230\u7ED3\u679C\u4E3A\n * before one\n * before two\n * after returning two\n * after returning one\n */\n@Aspect\npublic class MultiAdviceAspect {\n	@Pointcut("execution(boolean *.execute(String, ..))")\n	public void taskExecution(){}\n\n	@Before("taskExecution()")\n	public void beforeOne() {\n		System.out.println("before one");\n	}\n\n	@Before("taskExecution()")\n	public void beforeTwo() {\n		System.out.println("before two");\n	}\n\n	@AfterReturning("taskExecution()")\n	public void afterReturningOne() {\n		System.out.println("after retuning one");\n	}\n\n	@AfterReturning("taskExecution()")\n	public void afterReturningTwo() {\n		System.out.println("after retuning two");\n	}\n}\n'})})]}),"\n",(0,i.jsx)(e.p,{children:"\u5F53\u8FD9\u4E9BAdvice\u58F0\u660E\u5728\u4E0D\u540C\u7684Aspect\u5185\u7684\u65F6\u5019\u3002\u5982\u679C\u591A\u4E2AAdvice\u58F0\u660E\u6240\u5BF9\u5E94\u7684Pointcut\u5B9A\u4E49\u5339\u914D\u540C\u4E00\u4E2AJoinpoint\uFF0C\u4F46\u5B83\u4EEC\u53C8\u4E0D\u662F\u58F0\u660E\u5728\u540C\u4E00\u4E2AAspect\u5185\u7684\u8BDD\u3002\u6211\u4EEC\u9700\u8981\u7528\u5230Spring\u7684org.springframework.core.Ordered \u63A5\u53E3\uFF0C\u53EA\u9700\u8981\u8BA9\u76F8\u5E94\u7684Aspect\u5B9A\u4E49\u5B9E\u73B0Ordered\u63A5\u53E3\u5373\u53EF\uFF0C\u5426\u5219Advice\u6267\u884C\u987A\u5E8F\u662F\u4E0D\u786E\u5B9A\u7684\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://s2.loli.net/2023/07/15/NoimsEaDcIgdwMp.png",alt:""})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Note: \u5982\u679C\u901A\u8FC7\u7F16\u7A0B\u65B9\u5F0F\u6765\u4F7F\u7528\u8FD9\u4E9BAspect\uFF0CAspect\u5185\u7684Advice\u6267\u884C\u987A\u5E8F\u5B8C\u5168\u7531\u6DFB\u52A0\u5230AspectJProxyFactory\u7684\u987A\u5E8F\u51B3\u5B9A\uFF0C\u800C\u4E0D\u662FOrdered\u63A5\u53E3\u6240\u89C4\u5B9A\u7684\u987A\u5E8F\u3002\uFF0C\u5982\u679C\u91C7\u7528\u4E86\u5982\u4E0B\u4EE3\u7801\u7684\u987A\u5E8F\u7684\u8BDD\uFF0C\u90A3\u4E48AnotherAspect\u5185\u7684Advice\u8981\u6BD4MultiAdviceAspect\u5185\u7684Advice\u4F18\u5148\u6267\u884C\u3002"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://s2.loli.net/2023/07/15/aXrGAu1x6KwJgBj.png",alt:""})}),"\n",(0,i.jsx)(e.h3,{id:"aspect\u7684\u5B9E\u4F8B\u5316\u6A21\u5F0F",children:"Aspect\u7684\u5B9E\u4F8B\u5316\u6A21\u5F0F"}),"\n",(0,i.jsx)(e.p,{children:"\u5BF9\u4E8E\u6CE8\u518C\u5230\u5BB9\u5668\u7684\u5404\u4E2AAspect\uFF0C\u5B83\u9ED8\u8BA4\u7684\u5B9E\u4F8B\u5316\u6A21\u5F0F\u91C7\u7528\u7684\u662Fsingleton\uFF0C\u5728\u5BB9\u5668\u4E2D\u4F1A\u5B9E\u4F8B\u5316\u5E76\u6301\u6709\u6BCF\u4E2AAspect\u5B9A\u4E49\u7684\u5355\u4E00\u5B9E\u4F8B(\u884C\u4E3A\u4E0A\u6070\u597D\u4E0E\u5BB9\u5668singleton\u578Bscope\u7684\u884C\u4E3A\u76F8\u543B\u5408)"}),"\n",(0,i.jsx)(e.p,{children:"\u9664\u4E86\u5B9E\u4F8B\u5316\u6A21\u5F0F\uFF0CAspectJ\u8FD8\u652F\u6301perthis\u3001pertarget\u3001percflow\u3001percflowbelow\u4EE5\u53CAperwithin\u7B49\u5B9E\u4F8B\u5316\u6A21\u5F0F\uFF0C\u4E0D\u8FC7Spring2.0\u4E4B\u540EAOP\u53EA\u652F\u6301\u9ED8\u8BA4\u7684singleton\u3001perthis\u548Cpertarget\u4E09\u79CD\u5B9E\u4F8B\u5316\u6A21\u5F0F\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u8981\u60F3\u6307\u5B9A\u76F8\u5E94\u7684Aspect\u7684\u5B9E\u4F8B\u5316\u6A21\u5F0F\uFF0C\u53EF\u4EE5\u901A\u8FC7@Aspect\u6307\u5B9Aperthis\u6216\u8005pertarget\u8BED\u53E5\u3002\u5982\u679C\u60F3\u8BA9MultiAdviceAspect\u7684\u5B9E\u4F8B\u5316\u6A21\u5F0F\u4ECE\u9ED8\u8BA4\u7684singleton\u53D8\u6210perthis\u3002\u53EF\u4EE5\u5982\u4E0B\u6307\u5B9A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Aspect("perthis(execution(boolean *.execute(String, ..)))")\npublic class MultiAdviceAspect {\n\n    @Pointcut("execution(boolean *.execute(String, ..))")\n    public void taskExecution(){}\n    \n    // ..\n\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5728perthis\u6307\u5B9A\u7684Pointcut\u5B9A\u4E49\u5339\u914D\u4E4B\u540E\uFF0C\u4F1A\u4E3A\u76F8\u5E94\u7684\u4EE3\u7406\u5BF9\u8C61\u5B9E\u4F8B\u5316\u5404\u81EA\u7684Aspect\u5B9E\u4F8B\u3002\u5BF9\u4E8Epertarget\u6765\u8BF4\uFF0C\u5219\u662F\u4E3A\u4E86\u5339\u914D\u7684\u5355\u72EC\u76EE\u6807\u5BF9\u8C61\u5B9E\u4F8B\u5316\u76F8\u5E94\u7684Aspect\u3002\u4E0D\u8FC7\uFF0C\u4F7F\u7528\u4E86perthis\u6216\u8005pertarget\u6307\u5B9A\u4E86Aspect\u5B9E\u4F8B\u5316\u6A21\u5F0F\u4E4B\u540E\uFF0C\u5C06\u8FD9\u4E9BAspect\u6CE8\u518C\u5230\u5BB9\u5668\u65F6\uFF0C\u4E0D\u80FD\u4E3A\u5176bean\u5B9A\u4E49\u6307\u5B9Asingleton\u7684scope\uFF0C\u5426\u5219\u4F1A\u51FA\u73B0\u5F02\u5E38\u3002"}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"\u53C2\u8003\u8D44\u6599\uFF1A"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u4E66\u7C4D \u738B\u798F\u5F3A-Spring\u63ED\u79D8"}),"\n"]}),"\n"]}),"\n","\n",(0,i.jsx)(s.A,{})]})}function g(n={}){let{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(d,{...n})}):d(n)}}}]);